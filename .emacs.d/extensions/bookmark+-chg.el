<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>EmacsWiki: bookmark+-chg.el</title><link rel="alternate" type="application/wiki" title="Edit this page" href="http://www.emacswiki.org/emacs?action=edit;id=bookmark%2b-chg.el" /><link type="text/css" rel="stylesheet" href="/emacs/wiki.css" /><meta name="robots" content="INDEX,FOLLOW" /><link rel="alternate" type="application/rss+xml" title="EmacsWiki" href="http://www.emacswiki.org/emacs?action=rss" /><link rel="alternate" type="application/rss+xml" title="EmacsWiki: bookmark+-chg.el" href="http://www.emacswiki.org/emacs?action=rss;rcidonly=bookmark%2b-chg.el" />
<link rel="alternate" type="application/rss+xml"
      title="Emacs Wiki with page content"
      href="http://www.emacswiki.org/emacs/full.rss" />
<link rel="alternate" type="application/rss+xml"
      title="Emacs Wiki with page content and diff"
      href="http://www.emacswiki.org/emacs/full-diff.rss" />
<link rel="alternate" type="application/rss+xml"
      title="Emacs Wiki including minor differences"
      href="http://www.emacswiki.org/emacs/minor-edits.rss" />
<link rel="alternate" type="application/rss+xml"
      title="Changes for bookmark+-chg.el only"
      href="http://www.emacswiki.org/emacs?action=rss;rcidonly=bookmark%2b-chg.el" />
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2101513-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/></head><body class="http://www.emacswiki.org/emacs"><div class="header"><a class="logo" href="http://www.emacswiki.org/emacs/SiteMap"><img class="logo" src="/emacs_logo.png" alt="[Home]" /></a><span class="gotobar bar"><a class="local" href="http://www.emacswiki.org/emacs/SiteMap">SiteMap</a> <a class="local" href="http://www.emacswiki.org/emacs/Search">Search</a> <a class="local" href="http://www.emacswiki.org/emacs/ElispArea">ElispArea</a> <a class="local" href="http://www.emacswiki.org/emacs/HowTo">HowTo</a> <a class="local" href="http://www.emacswiki.org/emacs/Glossary">Glossary</a> <a class="local" href="http://www.emacswiki.org/emacs/RecentChanges">RecentChanges</a> <a class="local" href="http://www.emacswiki.org/emacs/News">News</a> <a class="local" href="http://www.emacswiki.org/emacs/Problems">Problems</a> <a class="local" href="http://www.emacswiki.org/emacs/Suggestions">Suggestions</a> </span>
<!-- Google CSE Search Box Begins  -->
<form class="tiny" action="http://www.google.com/cse" id="searchbox_004774160799092323420:6-ff2s0o6yi"><p>
<input type="hidden" name="cx" value="004774160799092323420:6-ff2s0o6yi" />
<input type="text" name="q" size="25" />
<input type="submit" name="sa" value="Search" />
</p></form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=searchbox_004774160799092323420%3A6-ff2s0o6yi"></script>
<!-- Google CSE Search Box Ends -->
<h1><a title="Click to search for references to this page" rel="nofollow" href="http://www.google.com/cse?cx=004774160799092323420:6-ff2s0o6yi&amp;q=%22bookmark%2b-chg.el%22">bookmark+-chg.el</a></h1></div><div class="wrapper"><div class="content browse"><p class="download"><a href="http://www.emacswiki.org/emacs/download/bookmark%2b-chg.el">Download</a></p><pre class="code"><span class="linecomment">;;; bookmark+-chg.el - Change logs for Bookmark+ libraries.</span>
<span class="linecomment">;;</span>
<span class="linecomment">;; Filename: bookmark+-chg.el</span>
<span class="linecomment">;; Description: Change logs for Bookmark+ libraries.</span>
<span class="linecomment">;; Author: Drew Adams</span>
<span class="linecomment">;; Maintainer: Drew Adams (concat "drew.adams" "@" "oracle" ".com")</span>
<span class="linecomment">;; Copyright (C) 2000-2011, Drew Adams, all rights reserved.</span>
<span class="linecomment">;; Created: Fri Sep 15 07:58:41 2000</span>
<span class="linecomment">;; Last-Updated: Tue Aug  9 10:29:22 2011 (-0700)</span>
<span class="linecomment">;;           By: dradams</span>
<span class="linecomment">;;     Update #: 13732</span>
<span class="linecomment">;; URL: http://www.emacswiki.org/cgi-bin/wiki/bookmark+-chg.el</span>
<span class="linecomment">;; Keywords: bookmarks, bookmark+</span>
<span class="linecomment">;; Compatibility: GNU Emacs: 20.x, 21.x, 22.x, 23.x</span>
<span class="linecomment">;;</span>
<span class="linecomment">;; Features that might be required by this library:</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;   None</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;; Commentary:</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;    Change log for the Bookmark+ libraries, which extend standard</span>
<span class="linecomment">;;    library `bookmark.el'.  This file contains no code, so you need</span>
<span class="linecomment">;;    not load it.</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;    The Bookmark+ libraries are these:</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;    `bookmark+.el'     - main (driver) code library</span>
<span class="linecomment">;;    `bookmark+-mac.el' - Lisp macros</span>
<span class="linecomment">;;    `bookmark+-lit'    - (optional) code for highlighting bookmarks</span>
<span class="linecomment">;;    `bookmark+-bmu.el' - code for the `*Bookmark List*' (bmenu)</span>
<span class="linecomment">;;    `bookmark+-1.el'   - other (non-bmenu) required code</span>
<span class="linecomment">;;    `bookmark+-key.el' - key and menu bindings</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;    `bookmark+-doc'    - documentation (comment-only file)</span>
<span class="linecomment">;;    `bookmark+-chg'    - change log (this file)</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;    The documentation (in `bookmark+-doc.el') includes how to</span>
<span class="linecomment">;;    byte-compile and install Bookmark+.  The documentation is also</span>
<span class="linecomment">;;    available in these ways:</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;    1. From the bookmark list (`C-x r l'):</span>
<span class="linecomment">;;       Use `?' to show the current bookmark-list status and general</span>
<span class="linecomment">;;       help, then click link `Doc in Commentary' or link `Doc on the</span>
<span class="linecomment">;;       Web'.</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;    2. From the Emacs-Wiki Web site:</span>
<span class="linecomment">;;       http://www.emacswiki.org/cgi-bin/wiki/BookmarkPlus.</span>
<span class="linecomment">;;    </span>
<span class="linecomment">;;    3. From the Bookmark+ group customization buffer:</span>
<span class="linecomment">;;       `M-x customize-group bookmark-plus', then click link</span>
<span class="linecomment">;;       `Commentary'.</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;    (The commentary links in #1 and #3 work only if you put library</span>
<span class="linecomment">;;    `bookmark+-doc.el' in your `load-path'.)</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;    ****** NOTE ******</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;      On 2010-06-18, I changed the prefix used by package Bookmark+</span>
<span class="linecomment">;;      from `bookmarkp-' to `bmkp-'.  THIS IS AN INCOMPATIBLE CHANGE.</span>
<span class="linecomment">;;      I apologize for the inconvenience, but the new prefix is</span>
<span class="linecomment">;;      preferable for a number of reasons, including easier</span>
<span class="linecomment">;;      distinction from standard `bookmark.el' names.</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;      This change means that YOU MUST MANUALLY REPLACE ALL</span>
<span class="linecomment">;;      OCCURRENCES of `bookmarkp-' by `bmkp-' in the following</span>
<span class="linecomment">;;      places, if you used Bookmark+ prior to this change:</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;      1. In your init file (`~/.emacs') or your `custom-file', if</span>
<span class="linecomment">;;         you have one.  This is needed if you customized any</span>
<span class="linecomment">;;         Bookmark+ features.</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;      2. In your default bookmark file, `bookmark-default-file'</span>
<span class="linecomment">;;         (`.emacs.bmk'), and in any other bookmark files you might</span>
<span class="linecomment">;;         have.</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;      3. In your `*Bookmark List*' state file,</span>
<span class="linecomment">;;         `bmkp-bmenu-state-file' (`~/.emacs-bmk-bmenu-state.el').</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;      4. In your `*Bookmark List*' commands file,</span>
<span class="linecomment">;;         `bmkp-bmenu-commands-file' (`~/.emacs-bmk-bmenu-commands.el'),</span>
<span class="linecomment">;;         if you have one.</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;      You can do this editing in a virgin Emacs session (`emacs</span>
<span class="linecomment">;;      -Q'), that is, without loading Bookmark+.</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;      Alternatively, you can do this editing in an Emacs session</span>
<span class="linecomment">;;      where Bookmark+ has been loaded, but in that case you must</span>
<span class="linecomment">;;      TURN OFF AUTOMATIC SAVING of both your default bookmark file</span>
<span class="linecomment">;;      and your `*Bookmark List*' state file.  Otherwise, when you</span>
<span class="linecomment">;;      quit Emacs your manually edits will be overwritten.</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;      To turn off this automatic saving, you can use `M-~' and `M-l'</span>
<span class="linecomment">;;      in buffer `*Bookmark List*' (commands</span>
<span class="linecomment">;;      `bmkp-toggle-saving-bookmark-file' and</span>
<span class="linecomment">;;      `bmkp-toggle-saving-menu-list-state' - they are also in the</span>
<span class="linecomment">;;      `Bookmark+' menu).</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;      Again, sorry for this inconvenience.</span>
 
<span class="linecomment">;;(@&gt; "Index")</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;  If you have library `linkd.el' and Emacs 22 or later, load</span>
<span class="linecomment">;;  `linkd.el' and turn on `linkd-mode' now.  It lets you easily</span>
<span class="linecomment">;;  navigate around the sections of this doc.  Linkd mode will</span>
<span class="linecomment">;;  highlight this Index, as well as the cross-references and section</span>
<span class="linecomment">;;  headings throughout this file.  You can get `linkd.el' here:</span>
<span class="linecomment">;;  http://dto.freeshell.org/notebook/Linkd.html.</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;  (@&gt; "CHANGE LOG FOR `bookmark+-1.el'")</span>
<span class="linecomment">;;  (@&gt; "CHANGE LOG FOR `bookmark+-bmu.el'")</span>
<span class="linecomment">;;  (@&gt; "CHANGE LOG FOR `bookmark+-key.el'")</span>
<span class="linecomment">;;  (@&gt; "CHANGE LOG FOR `bookmark+-lit.el'")</span>
<span class="linecomment">;;  (@&gt; "CHANGE LOG FOR `bookmark+-mac.el'")</span>
<span class="linecomment">;;  (@&gt; "CHANGE LOG FOR `bookmark+.el'")</span>
 
<span class="linecomment">;;;(@* "CHANGE LOG FOR `bookmark+-1.el'")</span>
<span class="linecomment">;;</span>
<span class="linecomment">;; 2011/08/09 dadams</span>
<span class="linecomment">;;     Bind icicle-unpropertize-completion-result-flag to t for all calls to completing-read.</span>
<span class="linecomment">;; 2011/08/07 dadams</span>
<span class="linecomment">;;     Added: bmkp-guess-default-handler-for-file-flag, bmkp-file-bookmark-handlers.</span>
<span class="linecomment">;;     bmkp-file-bookmark-p: Use bmkp-file-bookmark-handlers, which means also image-bookmark-jump.</span>
<span class="linecomment">;;     bmkp-make-record-for-target-file (need to keep in sync with diredp-bookmark):</span>
<span class="linecomment">;;       Instead of image-bookmark-make-record, use explicit function that includes file and type.</span>
<span class="linecomment">;;     bmkp-default-handler-for-file:</span>
<span class="linecomment">;;       Use bmkp-guess-default only if bmkp-guess-default-handler-for-file-flag is non-nil.</span>
<span class="linecomment">;;     bmkp-default-handler-associations: Updated doc string.</span>
<span class="linecomment">;; 2011/08/05 dadams</span>
<span class="linecomment">;;     bmkp-file-bookmark-p: Allow handler to be bmkp-default-handler-for-file, e.g. for image files.</span>
<span class="linecomment">;;     bmkp-all-tags-alist-only: Corrected.</span>
<span class="linecomment">;;     bmkp-refresh-menu-list: Ensure BOOKMARK is a string.</span>
<span class="linecomment">;;     bmkp-every: Removed unused binding.</span>
<span class="linecomment">;; 2011/05/08 dadams</span>
<span class="linecomment">;;     Just put some definitions in alphabetic order - no real change.</span>
<span class="linecomment">;; 2011/04/25 dadams</span>
<span class="linecomment">;;     bmkp-bookmark-description: Added optional arg NO-IMAGE.</span>
<span class="linecomment">;;     bmkp-url-target-set: Protect url-get-url-at-point with fboundp.</span>
<span class="linecomment">;;     bmkp-(file-target|autofile)-set, bmkp-autofile-(add|remove)-tags:</span>
<span class="linecomment">;;       Added buffer-file-name as a default possibility.  Removed URL functions for that purpose.</span>
<span class="linecomment">;; 2011/04/24 dadams</span>
<span class="linecomment">;;     Added: bmkp-purge-notags-autofiles.</span>
<span class="linecomment">;;     bookmark-delete: Redefined to accept either bookmark or name as arg.</span>
<span class="linecomment">;;     bmkp-(url|file|compilation|occur)-target-set(-all), bmkp-autofile-(set|(add|remove)-tags):</span>
<span class="linecomment">;;       Removed optional args when read prefix.</span>
<span class="linecomment">;;     bmkp-occur-target-set-all: Made PREFIX arg optional too.</span>
<span class="linecomment">;;     Added some missing autoload cookies.  Removed some from non-def sexps.</span>
<span class="linecomment">;; 2011/04/21 dadams</span>
<span class="linecomment">;;     Added: bmkp-copied-tags, bmkp-copy-tags, bmkp-paste-add-tags, bmkp-paste-replace-tags..</span>
<span class="linecomment">;; 2011/04/20 dadams</span>
<span class="linecomment">;;     bmkp-remove-all-tags: Added optional arg no-cache-update-p.</span>
<span class="linecomment">;; 2011/04/19 dadams</span>
<span class="linecomment">;;     bmkp-make-record-for-target-file: Fixed backquotes on lambdas.</span>
<span class="linecomment">;; 2011/04/17 dadams</span>
<span class="linecomment">;;     bmkp-edit-tags: Do not apply bmkp-full-tag to the tags.</span>
<span class="linecomment">;; 2011/04/16 dadams</span>
<span class="linecomment">;;     Added: bmkp-edit-tags(-send|-mode(-map)), bmkp-return-buffer.</span>
<span class="linecomment">;;     bookmark-(rename|relocate|send-edited-annotation), bmkp-update-autonamed-bookmark,</span>
<span class="linecomment">;;       bmkp-(add|remove(-all)-tags:</span>
<span class="linecomment">;;         Wrap with-current-buffer around bmkp-refresh-menu-list.</span>
<span class="linecomment">;;     bookmark-(store|rename|write-file): Test emacs-major-version, not just (boundp 'print-circle).</span>
<span class="linecomment">;;     bmkp-autofile-add-tags: Fix interactive args - forgot to include DIR arg (= nil).</span>
<span class="linecomment">;; 2011/04/15 dadams</span>
<span class="linecomment">;;     Added: bmkp-autofile-alist-only, bmkp-autofile-bookmark-p.</span>
<span class="linecomment">;; 2011/04/13 dadams</span>
<span class="linecomment">;;     Added: bmkp-autofile-jump(-other-window) (aliases), bmkp-find-file(-other-window).</span>
<span class="linecomment">;;     bmkp-find-file-(all|some)-tags(-regexp)(-other-window): Bind use-file-dialog to nil.</span>
<span class="linecomment">;; 2011/04/12</span>
<span class="linecomment">;;     Added: bmkp-bookmark-name-member, bmkp-names-same-bookmark-p, bmkp-sort-omit,</span>
<span class="linecomment">;;            bmkp-remove-omitted, bmkp-delete-bookmark-name-from-list, bmkp-bookmark-a-file (alias),</span>
<span class="linecomment">;;            bmkp-autofile-(add|remove)-tags, bmkp-(un)tag-a-file (aliases),</span>
<span class="linecomment">;;            bmkp-get-autofile-bookmark, bmkp-find-file-(all|some)-tags(-regexp)(-other-window).</span>
<span class="linecomment">;;     Removed: bmkp-remove-assoc-dups, bmkp-sort-and-remove-dups.</span>
<span class="linecomment">;;     Applied renaming: bmkp-bmenu-omitted-list to bmkp-bmenu-omitted-bookmarks.</span>
<span class="linecomment">;;     bookmark-store: Redefine for all Emacs versions now:</span>
<span class="linecomment">;;       Put the bookmark on the name as property bmkp-full-record.  Use bmkp-maybe-save-bookmarks.</span>
<span class="linecomment">;;       Return the bookmark.</span>
<span class="linecomment">;;     bookmark-get-bookmark: Redefine for all Emacs versions now:</span>
<span class="linecomment">;;       If BOOKMARK is a bookmark-name string that has property bmkp-full-record, return that value.</span>
<span class="linecomment">;;     bookmark-send-edited-annotation: Make sure it's the annotation buffer that gets killed.</span>
<span class="linecomment">;;     bookmark-default-handler: Return nil, like vanilla (but why?).</span>
<span class="linecomment">;;     bookmark-location: Pass full bookmark to the various "get" functions.</span>
<span class="linecomment">;;     bookmark-rename: Put bmkp-full-record property on new name.</span>
<span class="linecomment">;;     bookmark-delete:</span>
<span class="linecomment">;;       Use bmkp-delete-bookmark-name-from-list: If name has bmkp-full-record property, use that</span>
<span class="linecomment">;;         with name to find bookmark to delete.</span>
<span class="linecomment">;;       Pass full bookmark to unlight.</span>
<span class="linecomment">;;     bmkp-edit-bookmark: Save if either is non-empty, not if both are.  Thx to Michael Heerdegen.</span>
<span class="linecomment">;;     bmkp-edit-bookmark-record: Bind print-circle to t around pp.</span>
<span class="linecomment">;;     bmkp-default-bookmark-name:</span>
<span class="linecomment">;;       Use bookmark-name-from-full-record plus bookmark-get-bookmark, not assoc.</span>
<span class="linecomment">;;       If BNAME is nil (no default) then do not try to look it up in alist.</span>
<span class="linecomment">;;     bookmark-write-file: Unpropertize only for Emacs 20 or nil bmkp-propertize-bookmark-names-flag.</span>
<span class="linecomment">;;                          Bind print-circle to t around pp.</span>
<span class="linecomment">;;     bmkp-save-menu-list-state: Make it interactive (a command).  Bind print-circle.</span>
<span class="linecomment">;;                                Use bmkp-maybe-unpropertize-bookmark-names on alists and name lists.</span>
<span class="linecomment">;;                                Bind print-circle to t around pp.</span>
<span class="linecomment">;;     bmkp-unomit-all: Use bmkp-delete-bookmark-name-from-list, not delete.</span>
<span class="linecomment">;;     bmkp-dired-this-dir-bookmark-p: Use bmkp-same-file-p, not string=.</span>
<span class="linecomment">;;     bmkp-url-target-set, bmkp-replace-existing-bookmark:: Return the bookmark.</span>
<span class="linecomment">;;     bmkp-file-target-set:  Return bookmark.  Added arg MSGP: msg if no file yet.</span>
<span class="linecomment">;;     bmkp-autofile-set:</span>
<span class="linecomment">;;       Added DIR arg and MSGP arg: msg if no file yet.  Return the bookmark.</span>
<span class="linecomment">;;       If read absolute file name, create bmk in its dir, not in default-directory.  Else use DIR.</span>
<span class="linecomment">;;       Use bmkp-get-autofile-bookmark, so uses bmkp-same-file-p for each file part (not equal).</span>
<span class="linecomment">;;     bmkp-marked-bookmark-p, bmkp-omitted-bookmark-p: Use bmkp-bookmark-name-member, not member.</span>
<span class="linecomment">;;     bookmark-location: Pass full bookmark to the various "get" functions.</span>
<span class="linecomment">;;     bmkp-choose-navlist-from-bookmark-list, bmkp-cycle-this-buffer:</span>
<span class="linecomment">;;       Use bmkp-sort-omit, not bmkp-sort-and-remove-dups.</span>
<span class="linecomment">;;     bmkp-bookmark-description, bmkp-describe-bookmark-internals: Add Bookmark `' to title.</span>
<span class="linecomment">;;     bmkp-make-bookmark-list-record: Use bmkp-maybe-unpropertize-bookmark-names on lists.</span>
<span class="linecomment">;;     bmkp-printable-p: Bind print-circle to t around prin1.</span>
<span class="linecomment">;;     bmkp-delete-autonamed(-this-buffer)-no-confirm:</span>
<span class="linecomment">;;       Do nothing if bookmarks not loaded.  Thx to Christoph Scholtes.</span>
<span class="linecomment">;; 2011/04/03 dadams</span>
<span class="linecomment">;;     Added: bmkp-make-record-for-target-file, bmkp-replace-existing-bookmark (not used).</span>
<span class="linecomment">;;     bmkp-file-this-dir-bookmark-p: Corrected it to compare directory to default-directory.</span>
<span class="linecomment">;;     bmkp-file-target-set: Added arg NO-OVERWRITE (pass to bookmark-store).</span>
<span class="linecomment">;;                           Use (new) bmkp-make-record-for-target-file.</span>
<span class="linecomment">;;     bmkp-autofile-set: Do nothing if bookmark with same name, file and dir exists.</span>
<span class="linecomment">;;                        Else create one, even if the bookmark name is the same.</span>
<span class="linecomment">;;                        You can have multiple autofile bookmarks with the same name (diff files).</span>
<span class="linecomment">;; 2011/04/02 dadams</span>
<span class="linecomment">;;     Added: bmkp-autofile-set, bmkp-file-this-dir-(all|some)-tags(-regexp)-jump(-other-window),</span>
<span class="linecomment">;;            bmkp-file-this-dir-(all|some)-tags(-regexp)-alist-only.</span>
<span class="linecomment">;; 2011/04/01 dadams</span>
<span class="linecomment">;;     Moved key and menu bindings to (new) bookmark+-key.el.</span>
<span class="linecomment">;;     Added: bmkp-(dired|file)-this-dir-alist-only, bmkp-(dired|file)-this-dir-bookmark-p,</span>
<span class="linecomment">;;            bmkp-file-this-dir-jump(-other-window).</span>
<span class="linecomment">;;     Renamed: bmkp-dired-jump-current(*) to bmkp-dired-this-dir-jump(*).</span>
<span class="linecomment">;;     bmkp-dired-this-dir-jump(-other-window): Use bmkp-dired-this-dir-alist-only.</span>
<span class="linecomment">;;     bmkp-types-alist: Added (dired|file)-this-dir.</span>
<span class="linecomment">;;     Bound bmkp-(dired|file)-this-dir-jump to C-d and C-f in bookmark-jump(-other-window)-map.</span>
<span class="linecomment">;;     bmkp-jump-dired, bmkp-jump-man: Treat null bmkp-jump-display-function as display-buffer.</span>
<span class="linecomment">;; 2011/03/26 dadams</span>
<span class="linecomment">;;     Added: bmkp-file-(all|some)-tags(-regexp)-(alist-only|jump(-other-window)).</span>
<span class="linecomment">;;     bmkp-jump-menu: Added the new commands, but not Emacs 20, to avoid crash if byte-compiled.</span>
<span class="linecomment">;;     bmkp-bookmark-jump*-other-window: Simplified doc strings - refer to same-window version. </span>
<span class="linecomment">;; 2011/03/17 dadams</span>
<span class="linecomment">;;     bmkp-describe-bookmark: Added 10-pixel margin around thumbnail image.</span>
<span class="linecomment">;; 2011/03/11 dadams</span>
<span class="linecomment">;;     Protect use of mouse-wheel-*-event with boundp.  Thx to Chris Poole.</span>
<span class="linecomment">;; 2011/03/04 dadams</span>
<span class="linecomment">;;     bmkp-bookmark-description, bmkp-describe-bookmark: Added clickable thumbnail to the help.</span>
<span class="linecomment">;;     bmkp-bookmark-description: Split file name into dir & relname, so shorter line, in help.</span>
<span class="linecomment">;; 2011/03/03 dadams</span>
<span class="linecomment">;;     Added: bmkp-all-exif-data, bmkp-bookmark-image-bookmark-p.</span>
<span class="linecomment">;;     bmkp-bookmark-description: Handle image EXIF data.</span>
<span class="linecomment">;; 2011/01/03 dadams</span>
<span class="linecomment">;;     Removed autoload cookies from non def* sexps and from define-key and define-prefix-command.</span>
<span class="linecomment">;;     Added some missing autoload cookies for commands, in particular redefined standard commands.</span>
<span class="linecomment">;; 2010/12/10 dadams</span>
<span class="linecomment">;;     Added defalias for bookmark-name-from(-full)-record, to fix gratuitous Emacs name change.</span>
<span class="linecomment">;; 2010/10/22 dadams</span>
<span class="linecomment">;;     Uncommented key bindings for mouse wheel, since Emacs bug #6256 has now been fixed.</span>
<span class="linecomment">;;     bmkp-repeat-command: Don't bother to let-bind repeat-previous-repeated-command,</span>
<span class="linecomment">;;                          and use setq, not let, for last-repeatable-command. Thx to Stefan Monnier.</span>
<span class="linecomment">;; 2010/09/28 dadams</span>
<span class="linecomment">;;     Added: bmkp-delete-autonamed(-this-buffer)-no-confirm.</span>
<span class="linecomment">;; 2010/09/25 dadams</span>
<span class="linecomment">;;     Added: option bmkp-default-bookmark-name, bmkp-annotated-alist-only.</span>
<span class="linecomment">;;     Added: bmkp-(next|previous)-*(-repeat), using macro bmkp-define-next+prev-cycle-commands.</span>
<span class="linecomment">;;     bmkp-default-bookmark-name: Respect option.</span>
<span class="linecomment">;;     bookmark-edit-annotation-mode, bookmark-edit-annotation:</span>
<span class="linecomment">;;       Use bmkp-annotated-alist-only (and new bmkp-default-bookmark-name).</span>
<span class="linecomment">;;     bookmark-send-edited-annotation:</span>
<span class="linecomment">;;       End in orig buffer, not bmenu buffer.  Delete edit window.  Thx to Joe Bloggs.</span>
<span class="linecomment">;; 2010/09/24 dadams</span>
<span class="linecomment">;;     Added: bmkp-autonamed(-this-buffer)-jump(-other-window).  Bound to C-x j # (#|.) and menus.</span>
<span class="linecomment">;;     Added, using bmkp-define-cycle-command:</span>
<span class="linecomment">;;       bmkp-cycle-(autonamed|bookmark-list|desktop|dired|gnus|info|lighted|(local-|remote-)file|</span>
<span class="linecomment">;;                   man|non-file|remote-file|specific-(buffers|files)|variable-list|url)</span>
<span class="linecomment">;;                   (-other-window).</span>
<span class="linecomment">;;     Added redefinitions: bookmark-edit-annotation(-mode).</span>
<span class="linecomment">;;     Renamed: *varlist* to *variable-list*.</span>
<span class="linecomment">;;     bmkp-autoname-format: Added ^ to anchor numeral at beginning.</span>
<span class="linecomment">;;     bookmark--jump-via: Don't update autonamed if using w32 association.</span>
<span class="linecomment">;;     bmkp-update-autonamed-bookmark: bmkp-refresh-menu-list only if buffer list is displayed.</span>
<span class="linecomment">;;     *-(relocate|rename), *-update-autonamed-bookmark, *-remove-all-tags, *-(add|remove)-tags:</span>
<span class="linecomment">;;       Don't create bookmark-list buffer if doesn't exist.</span>
<span class="linecomment">;;     bookmark-show-(annotation|all-annotations): Restore selected window and frame focus.</span>
<span class="linecomment">;;     bmkp-completing-read-(buffer|file)-name: Added optional NO-DEFAULT-P arg.</span>
<span class="linecomment">;;     bmkp-describe-bookmark: Default to highlighted bookmarks on line, if there are any.</span>
<span class="linecomment">;;     bmkp-specific-(buffers|files)-jump(-other-window): Allow empty input, to end loop.</span>
<span class="linecomment">;;     bmkp-cycle: Ensure bmkp-current-nav-bookmark is a bookmark, else redefine.  Use %9d, not %d.</span>
<span class="linecomment">;;     bmkp-cycle-other-window: Added optional STARTOVERP arg here too.</span>
<span class="linecomment">;; 2010/09/20 dadams</span>
<span class="linecomment">;;     bmkp-choose-navlist-of-type: Empty input means "any".</span>
<span class="linecomment">;; 2010/09/16 dadams</span>
<span class="linecomment">;;     bmkp-read-bookmark-file-name:</span>
<span class="linecomment">;;       Removed extra default-filename in call to read-file-name.  Thx to Pedro Insua.</span>
<span class="linecomment">;; 2010/08/22 dadams</span>
<span class="linecomment">;;     Added: bmkp-regexp-filtered-annotation-alist-only.</span>
<span class="linecomment">;; 2010/08/20 dadams</span>
<span class="linecomment">;;     Added: bmkp-read-bookmark-file-name.</span>
<span class="linecomment">;;     bookmark-save, bookmark-load, bmkp-switch-bookmark-file, bmkp-use-bookmark-file-create:</span>
<span class="linecomment">;;       Use bmkp-read-bookmark-file-name.</span>
<span class="linecomment">;; 2010/08/19 dadams</span>
<span class="linecomment">;;     Require gnus-sum.el when compile (for macro).  Thx to S. Nemec.</span>
<span class="linecomment">;; 2010/08/18 dadams</span>
<span class="linecomment">;;     Removed eval-when-compile for bookmark+-lit.el.</span>
<span class="linecomment">;;     Replaced defvar of bmkp-edit-bookmark-record-mode-map with a define-key after derived mode.</span>
<span class="linecomment">;; 2010/08/17 dadams</span>
<span class="linecomment">;;     bmkp-edit-bookmark: Made interactive.  Bound to C-x p E.  Added optional INTERNALP arg.</span>
<span class="linecomment">;;     bmkp-info-bookmark-p: Return nil if a different handler.</span>
<span class="linecomment">;; 2010/08/15 dadams</span>
<span class="linecomment">;;     Moved bmkp-define-file-sort-predicate, bmkp-menu-bar-make-toggle to bookmark+-mac.el.</span>
<span class="linecomment">;;     Require: bookmark.el, bookmark+-mac.el.</span>
<span class="linecomment">;;     Require for compile: bookmark+-bmu.el, bookmark+-lit.el (soft).</span>
<span class="linecomment">;;     Ensure this file is loaded before compiling.</span>
<span class="linecomment">;;     bmkp-set-bookmark-file-bookmark: Added missing arg for error format string.</span>
<span class="linecomment">;; 2010/08/08 dadams</span>
<span class="linecomment">;;     bookmark-jump: Added optional arg DISPLAY-FUNCTION (Emacs 24).</span>
<span class="linecomment">;;     bookmark-handle-bookmark:</span>
<span class="linecomment">;;       Move non-default handler call outside condition-case.</span>
<span class="linecomment">;;       Updated for Emacs 24: Use error condition bookmark-error-no-filename.  Added props for it.</span>
<span class="linecomment">;;     bookmark-default-handler: Updated for Emacs 24: </span>
<span class="linecomment">;;       Signal condition bookmark-error-no-filename, not file-error, and pass (stringp FILE).</span>
<span class="linecomment">;;     bookmark-make-record-default: Added optional args NO-CONTEXT, POSITION (Emacs 24), and VISITS.</span>
<span class="linecomment">;;     bookmark-load: Updated for Emacs 24: Wrap with abbreviate-file-name.</span>
<span class="linecomment">;;     bmkp-jump-1: Allow arg to be a bookmark or its name.</span>
<span class="linecomment">;;     bmkp-gnus-bookmark-p: Updated for Emacs 24: Added gnus-summary-bookmark-jump.</span>
<span class="linecomment">;;     bmkp-jump-gnus: Different gnus-fetch-group call for Emacs 20, 21.</span>
<span class="linecomment">;;     bmkp-make-(desktop|varlist|bookmark-(file|list))-record: Call *-record-default with NO-CONTEXT.</span>
<span class="linecomment">;;     w3m-current-title: Use w3m-current-title as bookmark name.</span>
<span class="linecomment">;;     bmkp-w3m-set-new-buffer-name, bmkp-jump-w3m*: Require w3m.</span>
<span class="linecomment">;;     bmkp-make-gnus-record: Get bookmark name from gnus-summary-article-header.</span>
<span class="linecomment">;;     Update for Emacs 24: Bypass bmkp specific Gnus, man, and woman code.</span>
<span class="linecomment">;; 2010/08/06 dadams</span>
<span class="linecomment">;;     Added (and bound the commands):</span>
<span class="linecomment">;;       bmkp-(compilation|occur)-target-set(-all), bmkp-(file|url)-target-set,</span>
<span class="linecomment">;;       bmkp-default-handler-associations, bmkp-compilation-file+line-at,</span>
<span class="linecomment">;;       bmkp-default-handler-(for-file|user), bmkp-sound-jump.</span>
<span class="linecomment">;;     bmkp-occur-create-autonamed-bookmarks: Do not define it  for Emacs &lt; 22.  Protect wrt POS, BUF.</span>
<span class="linecomment">;;     Added to Bookmark menu: bmkp-(file|url)-target-set, bmkp-set-(bookmark-file|desktop)-bookmark.</span>
<span class="linecomment">;; 2010/08/04 dadams</span>
<span class="linecomment">;;     bmkp-edit-bookmark: Use new bookmark name for update of dired-directory.  Thx to Kai Tetzlaff.</span>
<span class="linecomment">;; 2010/08/03 dadams</span>
<span class="linecomment">;;     bmkp-make-url-browse-record: Remove text properties from URL arg.</span>
<span class="linecomment">;; 2010/07/17 dadams</span>
<span class="linecomment">;;     Added: bmkp-url-jump-(other-window), bmkp-url(-browse)-(alist-only|bookmark-p), bmkp-url-cp,</span>
<span class="linecomment">;;            bmkp-url-history, bmkp-make-url-browse-record, bmkp-jump-url-browse.</span>
<span class="linecomment">;;     bmkp-sort-comparer: Use bmkp-url-cp, not bmkp-w3m-cp.</span>
<span class="linecomment">;;     bmkp-types-alist: w3m -&gt; url.</span>
<span class="linecomment">;;     bookmark-alist: Updated doc string to mention LOCATION.  W3M -&gt; URL.</span>
<span class="linecomment">;;     bmkp-bookmark-description: Treat URL.  Set no-position-p depending on start.</span>
<span class="linecomment">;;     Bind bmkp-url-jump*.  Replace W3M by URL in menu items.</span>
<span class="linecomment">;; 2010/07/14 dadams</span>
<span class="linecomment">;;     Created from bookmark+.el code.</span>
 
<span class="linecomment">;;;(@* "CHANGE LOG FOR `bookmark+-bmu.el'")</span>
<span class="linecomment">;;</span>
<span class="linecomment">;; 2011/07/01 dadams</span>
<span class="linecomment">;;     bmkp-bmenu-change-sort-order, bmkp(-multi)-reverse-sort-order: Handle null CURRENT-BMK.</span>
<span class="linecomment">;; 2011/04/24 dadams</span>
<span class="linecomment">;;     Added to Tags menu: Purge Autofiles with No Tags.</span>
<span class="linecomment">;; 2011/04/23 dadams</span>
<span class="linecomment">;;     Bound bmkp-bmenu-set-tag-value-for-marked to T &gt; v and added to bmkp-bmenu-tags-menu.</span>
<span class="linecomment">;;     bmkp-bmenu-mouse-3-menu: Added bmkp-rename-tag.</span>
<span class="linecomment">;; 2011/04/22 dadams</span>
<span class="linecomment">;;     Bound *-copy-tags to T c, T M-w, *-paste(-add|replace)-tags to T p, T C-y, T q.</span>
<span class="linecomment">;; 2011/04/21 dadams</span>
<span class="linecomment">;;     Added:  bmkp-bmenu-copy-tags, bmkp-bmenu-paste-add-tags(-to-marked),</span>
<span class="linecomment">;;             bmkp-bmenu-paste-replace-tags(-for-marked).</span>
<span class="linecomment">;;     Bound and added to menus: bmkp-bmenu-paste-add-tags-to-marked,</span>
<span class="linecomment">;;                               bmkp-bmenu-paste-replace-tags-for-marked.</span>
<span class="linecomment">;;     Added to This Bookmark menu: bmkp-bmenu-copy-tags, bmkp-bmenu-paste(-add|replace)-tags.</span>
<span class="linecomment">;; 2011/04/19 dadams</span>
<span class="linecomment">;;     Added: bmkp-bmenu-unmark-bookmarks-tagged-regexp.  Bound it to T u %.  Added it to menu.</span>
<span class="linecomment">;; 2011/04/16 dadams</span>
<span class="linecomment">;;     Added: bmkp-edit-tags-send.  Bound it to T e in bookmark-bmenu-mode-map.</span>
<span class="linecomment">;;     bookmark-bmenu-mode: Updated help text for tags editing.</span>
<span class="linecomment">;;     bmkp-maybe-unpropertize-bookmark-names:</span>
<span class="linecomment">;;       Test emacs-major-version, not just (boundp 'print-circle).</span>
<span class="linecomment">;; 2011/04/15 dadams</span>
<span class="linecomment">;;     Added: bmkp-bmenu-mark-autofile-bookmarks, bmkp-bmenu-show-only-autofiles.</span>
<span class="linecomment">;;       And added them to menus.</span>
<span class="linecomment">;;     bookmark-bmenu-mode-map:</span>
<span class="linecomment">;;       Bind bmkp-bmenu-mark-autofile-bookmarks, bmkp-bmenu-show-only-autofiles to A M, A S.</span>
<span class="linecomment">;;       Bind bookmark-bmenu-show-all-annotations to M-a, not A.</span>
<span class="linecomment">;;       Bind bmkp-bmenu-search-marked-bookmarks-regexp to M-s a M-s, not M-a.</span>
<span class="linecomment">;;       Bind *-mark-url-bookmarks, *-show-only-urls to M-u M-m, M-u M-s, not M-u M, M-u S.</span>
<span class="linecomment">;;     bookmark-bmenu-mode: Updated help to reflect latest bindings.</span>
<span class="linecomment">;; 2011/04/13 dadams</span>
<span class="linecomment">;;     bmkp-bmenu-tags-menu: Added: bmkp-(un)tag-a-file.</span>
<span class="linecomment">;; 2011/04/12</span>
<span class="linecomment">;;     Added: bmkp-propertize-bookmark-names-flag, bmkp-maybe-unpropertize-bookmark-names,</span>
<span class="linecomment">;;            bmkp-bmenu-get-marked-files.</span>
<span class="linecomment">;;     Renamed: bmkp-bmenu-omitted-list to bmkp-bmenu-omitted-bookmarks.</span>
<span class="linecomment">;;     bmkp-bmenu-define-full-snapshot-command:</span>
<span class="linecomment">;;       Bind print-circle to t around pp.  Use bmkp-maybe-unpropertize-bookmark-names on lists.</span>
<span class="linecomment">;;     bookmark-bmenu-(show|hide)-filenames, bmkp-bmenu-toggle-show-only-(un)marked,</span>
<span class="linecomment">;;       bmkp-bmenu-(un)omit-marked:</span>
<span class="linecomment">;;         Fit one-window frame only if selected window is *Bookmark List*.</span>
<span class="linecomment">;;     bookmark-bmenu-bookmark: Added optional arg FULL.  Non-nil means return full bookmark record.</span>
<span class="linecomment">;;     bookmark-bmenu-unmark, bookmark-bmenu-delete, bmkp-bmenu-unomit-marked:</span>
<span class="linecomment">;;       Use bmkp-delete-bookmark-name-from-list, not delete.</span>
<span class="linecomment">;;     bookmark-bmenu-execute-deletions: Pass full bookmark, not name, to delete, and don't use assoc.</span>
<span class="linecomment">;;     bookmark-bmenu-rename: Use bmkp-bmenu-goto-bookmark-named instead of just searching for name.</span>
<span class="linecomment">;;     bmkp-bmenu-toggle-marks, bmkp-bmenu-unomit-marked, bmkp-bmenu-define-jump-marked-command,</span>
<span class="linecomment">;;       bmkp-bmenu-mouse-3-menu:</span>
<span class="linecomment">;;         Use bmkp-bookmark-name-member, not member.</span>
<span class="linecomment">;;     bmkp-bmenu-make-sequence-from-marked: Do not invoke bookmark-bmenu-list when no displayed list.</span>
<span class="linecomment">;;     bmkp-bmenu-define-command: Use bmkp-maybe-unpropertize-bookmark-names on *-omitted-bookmarks.</span>
<span class="linecomment">;;     bmkp-bmenu-list-1: Use bmkp-sort-omit, not bmkp-sort-and-remove-dups.</span>
<span class="linecomment">;;                        Pass full bookmark to bmkp-bmenu-propertize-item.</span>
<span class="linecomment">;;     bmkp-bmenu-propertize-item:</span>
<span class="linecomment">;;       First arg is now a full bookmark, not a bookmark name.  Get bookmark name from it.</span>
<span class="linecomment">;;       Put prop bmkp-bookmark-name on buffer text with propertized bookmark-name string as value.</span>
<span class="linecomment">;;       String has property bmkp-full-record with value the full bookmark record, with string as car.</span>
<span class="linecomment">;;       Return propertized bookmark-name string.</span>
<span class="linecomment">;;     bmkp-bmenu-isearch-marked-bookmarks(-regexp), bmkp-bmenu-dired-marked,</span>
<span class="linecomment">;;       bmkp-bmenu-(search|query-replace)-marked-bookmarks-regexp:</span>
<span class="linecomment">;;         Use bmkp-sort-omit, not bmkp-sort-and-remove-dups.</span>
<span class="linecomment">;;     bmkp-bmenu-goto-bookmark-named:</span>
<span class="linecomment">;;       If NAME has property bmkp-full-record then go to the bookmark it indicates.  Otherwise, just</span>
<span class="linecomment">;;       go to the first bookmark with the same name.</span>
<span class="linecomment">;;     bookmark-bmenu-mode: Added bmkp-save-menu-list-state (now a command) to the mode help.</span>
<span class="linecomment">;; 2011/04/02 dadams</span>
<span class="linecomment">;;     bookmark-bmenu-mode: Added to mode help: bmkp-file-this-dir-(all|some)-tags(-regexp)-jump.,</span>
<span class="linecomment">;;                                              Create/Set section, with bmkp-autofile-set.</span>
<span class="linecomment">;; 2011/04/01 dadams</span>
<span class="linecomment">;;     bookmark-bmenu-mode: Added to mode help: bmkp-(dired|file)-this-dir-jump.</span>
<span class="linecomment">;; 2011/03/26 dadams</span>
<span class="linecomment">;;     bookmark-bmenu-mode: Added new file-with-tags jump commands to the help.</span>
<span class="linecomment">;; 2011/03/05 dadams</span>
<span class="linecomment">;;     bmkp-bmenu-edit-bookmark: Use bmkp-refresh-menu-list, not *-surreptitiously-rebuild-list.</span>
<span class="linecomment">;; 2011/02/11 dadams</span>
<span class="linecomment">;;     Faces: Better defaults for dark background.</span>
<span class="linecomment">;; 2011/01/03 dadams</span>
<span class="linecomment">;;     Removed autoload cookies from non def* sexps and from define-key.</span>
<span class="linecomment">;;     Added missing autoload cookies for commands, in particular redefined std commands & defalias.</span>
<span class="linecomment">;; 2010/12/10 dadams</span>
<span class="linecomment">;;     Added defalias for bookmark-name-from(-full)-record, to fix gratuitous Emacs name change.</span>
<span class="linecomment">;; 2010/09/24 dadams</span>
<span class="linecomment">;;     Added: bmkp-bmenu-show-only-autonamed.  Bound to # S.  Added to bmkp-bmenu-show-menu.</span>
<span class="linecomment">;;     bookmark-bmenu-mode: Updated doc string for autonamed jumps, show.</span>
<span class="linecomment">;;     Renamed varlist to variable-list everywhere.</span>
<span class="linecomment">;; 2010/08/22 dadams</span>
<span class="linecomment">;;     Added: bmkp-bmenu-filter-annotation-incrementally, bookmark-bmenu-relocate (Emacs 20, 21),</span>
<span class="linecomment">;;            bmkp-bmenu-filter-alist-by-annotation-regexp.  Bound, added to menus and help.</span>
<span class="linecomment">;; 2010/08/18 dadams</span>
<span class="linecomment">;;     Removed eval-when-compile for bookmark+-(lit|1).el.</span>
<span class="linecomment">;;     bmkp-bmenu-propertize-item: Inconsequential simplification.</span>
<span class="linecomment">;; 2010/08/17 dadams</span>
<span class="linecomment">;;     bmkp-bmenu-edit-bookmark: Added optional arg INTERNALP (prefix arg), for editing record.</span>
<span class="linecomment">;; 2010/08/15 dadams</span>
<span class="linecomment">;;     Moved to bookmark+-mac.el:</span>
<span class="linecomment">;;       bmkp-define-sort-command, bmkp-replace-regexp-in-string, bmkp-assoc-delete-all.</span>
<span class="linecomment">;;     Renamed: bmkp-barf-if-not-in-menu-list to bmkp-bmenu-barf-if-not-in-menu-list.</span>
<span class="linecomment">;;     Require bookmark.el, bookmark+-mac.el.</span>
<span class="linecomment">;;     Require when compile: bookmark+-1.el, bookmark+-lit.el (soft).</span>
<span class="linecomment">;; 2010/07/17 dadams</span>
<span class="linecomment">;;     Added: bmkp-bmenu-mark-url-bookmarks, bmkp-bmenu-show-only-urls, bmkp-bmenu-sort-by-url.</span>
<span class="linecomment">;;     Removed: bmkp-bmenu-sort-by-w3m-url.</span>
<span class="linecomment">;;     Replaced face bmkp-w3m by bmkp-url.</span>
<span class="linecomment">;;     bookmark-bmenu-mode: Added mark and show URL commands.</span>
<span class="linecomment">;;     bookmark-bmenu-mode, *-status-help, *-sort-by-bookmark-type, *-define-sort-command: w3m -&gt; url.</span>
<span class="linecomment">;;     Bind bmkp-bmenu-sort-by-url, not bmkp-bmenu-sort-by-w3m-url.</span>
<span class="linecomment">;;     Bind bmkp-bmenu-mark-url-bookmarks, bmkp-bmenu-show-only-urls.</span>
<span class="linecomment">;;     Replace W3M by URL in menu items.</span>
<span class="linecomment">;; 2010/07/14 dadams</span>
<span class="linecomment">;;     Created from bookmark+.el code.</span>
 
<span class="linecomment">;;;(@* "CHANGE LOG FOR `bookmark+-key.el'")</span>
<span class="linecomment">;;</span>
<span class="linecomment">;; 2011/04/24 dadams</span>
<span class="linecomment">;;     Added to Bookmarks menu and its Tags submenu: Purge Autofiles with No Tags.</span>
<span class="linecomment">;; 2011/04/23 dadams</span>
<span class="linecomment">;;     bmkp-tags-menu:</span>
<span class="linecomment">;;       Added bmkp-set-tag-value, bmkp-(add|remove|copy)-tags, bmkp-paste-(add|replace)-tags.</span>
<span class="linecomment">;; 2011/04/21 dadams</span>
<span class="linecomment">;;     Bound: bmkp-copy-tags, bmkp-paste-add-tags, bmkp-paste-replace-tags.</span>
<span class="linecomment">;; 2011/04/16 dadams</span>
<span class="linecomment">;;     Added: bmkp-tags-map.  Bound tag commands to prefix C-x p t.</span>
<span class="linecomment">;; 2011/04/14 dadams</span>
<span class="linecomment">;;     Renamed menu Jump To Bookmark to just Jump To, in menu-bar-bookmark-map.</span>
<span class="linecomment">;; 2011/04/13 dadams</span>
<span class="linecomment">;;     Added:</span>
<span class="linecomment">;;       bmkp-find-file-menu (bmkp-find-file(-(all|some)-tags(-regexp)(-other-window)),</span>
<span class="linecomment">;;       bmkp-jump-tags-menu (what was in main, plus bmkp-find-file-*-tags-regexp*),</span>
<span class="linecomment">;;       bmkp-tags-menu (list all, rename, remove from all, (un)tag a file).</span>
<span class="linecomment">;;     bmkp-jump(-other-window)-map:</span>
<span class="linecomment">;;       Added bmkp-find-file(-other-window) to menu.</span>
<span class="linecomment">;;       Bound keys for bmkp-find-file-(all|some)-tags(-regexp)(-other-window): C-x (4) j t a...</span>
<span class="linecomment">;; 2011/04/02 dadams</span>
<span class="linecomment">;;     Added bindings for (new) bmkp-autofile-set,</span>
<span class="linecomment">;;                              bmkp-file-this-dir-(all|some)-tags(-regexp)-jump(-other-window).</span>
<span class="linecomment">;; 2011/04/01 dadams</span>
<span class="linecomment">;;     Added to bmkp-jump-menu: bmkp-(dired|file)-this-dir-jump-other-window.</span>
<span class="linecomment">;;     Created from code in bookmark+-1.el.</span>
 
<span class="linecomment">;;;(@* "CHANGE LOG FOR `bookmark+-lit.el'")</span>
<span class="linecomment">;;</span>
<span class="linecomment">;; 2011/08/09 dadams</span>
<span class="linecomment">;;     Bind icicle-unpropertize-completion-result-flag to t for all calls to completing-read.</span>
<span class="linecomment">;; 2011/04/12</span>
<span class="linecomment">;;     bmkp-cycle-lighted-this-buffer: Use bmkp-sort-omit, not bmkp-sort-and-remove-dups.</span>
<span class="linecomment">;; 2011/04/01 dadams</span>
<span class="linecomment">;;     bmkp-light-bookmark(s): Don't call bookmark-handle-bookmark.  Wrap with with-current-buffer.</span>
<span class="linecomment">;; 2011/01/03 dadams</span>
<span class="linecomment">;;     Added autoload cookies: defcustoms and commands.</span>
<span class="linecomment">;; 2010/12/10 dadams</span>
<span class="linecomment">;;     Added defalias for bookmark-name-from(-full)-record, to fix gratuitous Emacs name change.</span>
<span class="linecomment">;; 2010/09/25 dadams</span>
<span class="linecomment">;;     Added: bmkp-set-lighting-for(bookmarks|(-this)-buffer).  Requested by Joe Bloggs.</span>
<span class="linecomment">;;     bmkp-set-lighting-for-bookmark: Added LIGHT-NOW-P arg (from prefix arg).</span>
<span class="linecomment">;; 2010/09/11 dadams</span>
<span class="linecomment">;;     Removed eval-when-compile for bookmark+-bmu, bookmark+-1.</span>
<span class="linecomment">;; 2010/08/15 dadams</span>
<span class="linecomment">;;     Require: bookmark.el.</span>
<span class="linecomment">;;     Require when compile: bookmark+-bmu.el, bookmark+-1.el, pp+.el (soft).</span>
<span class="linecomment">;;     Applied renaming of bmkp-barf-if-not-in-menu-list to bmkp-bmenu-barf-if-not-in-menu-list.</span>
<span class="linecomment">;;     bmkp-light-bookmark(s): Added missing arg to throw call.</span>
<span class="linecomment">;;     bmkp-light-bookmarks: Use bmkp-remove-if, not remove-if.</span>
<span class="linecomment">;;     bmkp-light-bookmarks-in-region, bmkp-light-non-autonamed-this-buffer:</span>
<span class="linecomment">;;       Use bmkp-remove-if-not, not remove-if-not.</span>
<span class="linecomment">;;     bmkp-read-set-lighting-args: Use pp-read-expression-map only if bound (pp+.el).</span>
<span class="linecomment">;; 2010/07/03 dadams</span>
<span class="linecomment">;;     bmkp-set-lighting-for-bookmark, bmkp-bmenu-set-lighting-for-marked:</span>
<span class="linecomment">;;       Use *-refresh-menu-list, not *-surreptitiously-*.</span>
<span class="linecomment">;; 2010/07/01 dadams</span>
<span class="linecomment">;;     Created.</span>
 
<span class="linecomment">;;;(@* "CHANGE LOG FOR `bookmark+-mac.el'")</span>
<span class="linecomment">;;</span>
<span class="linecomment">;; 2011/04/12</span>
<span class="linecomment">;;     bmkp-define-cycle-command: Use bmkp-sort-omit, not bmkp-sort-and-remove-dups.</span>
<span class="linecomment">;; 2011/01/03 dadams</span>
<span class="linecomment">;;     Added autoload cookies: defmacro.</span>
<span class="linecomment">;; 2010/09/25 dadams</span>
<span class="linecomment">;;     Added: bmkp-define-next+prev-cycle-commands.</span>
<span class="linecomment">;; 2010/09/24 dadams</span>
<span class="linecomment">;;     Added: bmkp-define-cycle-command.</span>
<span class="linecomment">;; 2010/08/18 dadams</span>
<span class="linecomment">;;     Removed eval-when-compile for bookmark+-(bmu|1).el.</span>
<span class="linecomment">;; 2010/08/15 dadams</span>
<span class="linecomment">;;     Created, from code in other Bookmark+ files.</span>
 
<span class="linecomment">;;;(@* "CHANGE LOG FOR `bookmark+.el'")</span>
<span class="linecomment">;;</span>
<span class="linecomment">;; 2011/04/12 dadams</span>
<span class="linecomment">;;     Version 3.2.2.</span>
<span class="linecomment">;; 2011/04/01 dadams</span>
<span class="linecomment">;;     Require bookmark+-key.el (new).  Version 3.2.1.</span>
<span class="linecomment">;; 2011/01/03 dadams</span>
<span class="linecomment">;;     Added autoload cookies: defconst, command.</span>
<span class="linecomment">;; 2010/08/19</span>
<span class="linecomment">;;     bmkp-version-number: Version 3.2.0.</span>
<span class="linecomment">;; 2010/08/15 dadams</span>
<span class="linecomment">;;     Require bookmark+-mac.el.</span>
<span class="linecomment">;;     Do not ensure loaded before compile (not needed here now).</span>
<span class="linecomment">;; 2010/07/14 dadams</span>
<span class="linecomment">;;     Version 3.1.1.</span>
<span class="linecomment">;;     Moved main content of bookmark+.el to new files bookmark+-1.el and bookmark+-bmu.el.</span>
<span class="linecomment">;; 2010/07/13 dadams</span>
<span class="linecomment">;;     Version 3.1.0.</span>
<span class="linecomment">;;     Added redefinitions: bookmark-bmenu-(1|2)-window, bookmark-bmenu-other-window-with-mouse,</span>
<span class="linecomment">;;                          bookmark-bmenu-this-window, bookmark-bmenu-switch-other-window.</span>
<span class="linecomment">;;     Added: bmkp-last-bookmark-file, bmkp-switch-to-last-bookmark-file.</span>
<span class="linecomment">;;     Removed pre-23 version of bookmark-bmenu-switch-other-window.</span>
<span class="linecomment">;;     bookmark-load: Use bmkp-last-bookmark-file when read file name.  Added missing prefix arg.</span>
<span class="linecomment">;;                    Save old current as bmkp-last-bookmark-file.</span>
<span class="linecomment">;;     bookmark-bmenu-list: If bookmark file has changed do not restore state saved from other file.</span>
<span class="linecomment">;;                          Save old current as bmkp-last-bookmark-file.</span>
<span class="linecomment">;;     bmkp-bmenu-list-1: Do not use bmkp-bmenu-title if it is empty ("").</span>
<span class="linecomment">;;     bookmark-bmenu-mode: Added to doc string: bmkp-switch-bookmark-file.</span>
<span class="linecomment">;;     bookmark-bmenu-other-window: Do not bind bookmark-automatically-show-annotations (per vanilla).</span>
<span class="linecomment">;;     bookmark-bmenu-show-annotation: Ensure in bmenu list and on a bookmark line.</span>
<span class="linecomment">;;     bmkp-switch-bookmark-file: Use bmkp-last-bookmark-file when read file name.</span>
<span class="linecomment">;;     bmkp-bmenu-define-full-snapshot-command: Set bmkp-last-bookmark-file.</span>
<span class="linecomment">;;     bmkp-bookmark-description: Fixed typo: bmkp-bookmark-file-bookmark-p (not desktop).</span>
<span class="linecomment">;;     bmkp-make-bookmark-file-record: Use arg file (not bmkp-non-file-filename) as filename entry.</span>
<span class="linecomment">;;     </span>
<span class="linecomment">;;     Added more autoload cookies.</span>
<span class="linecomment">;; 2010/07/09 dadams</span>
<span class="linecomment">;;     Added: bmkp-bmenu-mark-bookmark-file-bookmarks, bmkp-bmenu-show-only-bookmark-files,</span>
<span class="linecomment">;;            bmkp-bookmark-file-jump, bmkp-set-bookmark-file-bookmark, bmkp-bookmark-file-history,</span>
<span class="linecomment">;;            bmkp-use-bookmark-file-create, bmkp-bookmark-file, bmkp-bookmark-file-alist-only,</span>
<span class="linecomment">;;            bmkp-bookmark-file-bookmark-p, bmkp-jump-bookmark-file, bmkp-make-bookmark-file-record.</span>
<span class="linecomment">;;     bmkp-types-alist, bmkp-buffer-names, bmkp-bmenu-mode-status-help, bmkp-bmenu-propertize-item,</span>
<span class="linecomment">;;       bmkp-this-buffer-p, bmkp-last-specific-buffer-p, bmkp-specific-buffers-alist-only,</span>
<span class="linecomment">;;       bmkp-bookmark-description, bookmark-bmenu-mode:   Updated for bookmark-file bookmarks.</span>
<span class="linecomment">;;     bookmark--jump-via: Added a catch, so a handler can skip all other processing when it's done.</span>
<span class="linecomment">;;     bookmark-load: Final msg says whether overwritten.</span>
<span class="linecomment">;;     Bound and added to menus: bmkp-set-bookmark-file-bookmark,</span>
<span class="linecomment">;;                               bmkp-bmenu-mark-bookmark-file-bookmarks,</span>
<span class="linecomment">;;                               bmkp-bmenu-show-only-bookmark-files, bmkp-bookmark-file-jump.</span>
<span class="linecomment">;; 2010/07/07 dadams</span>
<span class="linecomment">;;     bookmark-handle-bookmark: Bind use-dialog-box, use-file-dialog to nil.</span>
<span class="linecomment">;;     bookmark-location: From Emacs 23: Use location property and -- Unknown location --.</span>
<span class="linecomment">;;     bmkp-switch-bookmark-file: Bind insert-default-directory to nil.</span>
<span class="linecomment">;;     bmkp-empty-file: Expand FILE.  Return FILE.</span>
<span class="linecomment">;; 2010/07/03 dadams</span>
<span class="linecomment">;;     Added: bmkp-bmenu-describe-marked, bmkp-bookmark-description.</span>
<span class="linecomment">;;     bmkp-describe-bookmark: Rewrote to use bmkp-bookmark-description.</span>
<span class="linecomment">;;     Bound bmkp-bmenu-describe-marked to C-h &gt;.</span>
<span class="linecomment">;;     bmkp-bmenu-menubar-menu: Added bmkp-bmenu-describe-(marked|bookmark).</span>
<span class="linecomment">;;     Updated doc string of bookmark-alist.</span>
<span class="linecomment">;; 2010/07/01 dadams</span>
<span class="linecomment">;;     Added: bmkp-bmenu-mark-lighted-bookmarks, bmkp-bmenu-set-tag-value-for-marked,</span>
<span class="linecomment">;;            bmkp-bmenu-show-only-tagged, bmkp-occur-create-autonamed-bookmarks,</span>
<span class="linecomment">;;            bmkp-set-autonamed-bookmark, bmkp-set-autonamed-bookmark-at-line,</span>
<span class="linecomment">;;            bmkp-set-autonamed-regexp-buffer, bmkp-set-autonamed-regexp-region,</span>
<span class="linecomment">;;            bmkp-set-tag-value-for-navlist, bmkp-prompt-for-tags-flag, bmkp-menu-bar-make-toggle,</span>
<span class="linecomment">;;            bmkp-same-creation-time-p, bmkp-set-tag-value-for-bookmarks,</span>
<span class="linecomment">;;            bmkp(-bmenu)-highlight-menu, bmkp-options-menu.</span>
<span class="linecomment">;;     Renamed: bmkp-use-region-flag to bmkp-use-region,</span>
<span class="linecomment">;;              bmkp-bmenu-jump-menu to bmkp-jump-menu.</span>
<span class="linecomment">;;     Removed: bmkp-cycle-this-buffer-buff (unused).</span>
<span class="linecomment">;;     Soft-require new library bookmark+-lit.el.</span>
<span class="linecomment">;;     Split off new file bookmark+-chg.el from bookmark+-doc.el.</span>
<span class="linecomment">;;     Changed default values of faces bmkp-&gt;-mark, bmkp-t-mark.</span>
<span class="linecomment">;;     bmkp-crosshairs-flag: Added :set instead of add-hook at top level.</span>
<span class="linecomment">;;     bmkp-use-region: Changed from boolean to choice - added cycling-too value.</span>
<span class="linecomment">;;     bookmark-set: Added INTERACTIVEP arg.  Prompt for tags when bmkp-prompt-for-tags-flag.</span>
<span class="linecomment">;;                   Auto-highlight when set, per bmkp-auto-light-when-set.</span>
<span class="linecomment">;;     bookmark--jump-via: Auto-highlight when jump, per bmkp-auto-light-when-jump.</span>
<span class="linecomment">;;                         Set BOOKMARK to result of bmkp-update-autonamed-bookmark.</span>
<span class="linecomment">;;                         Bind orig-buff when running hook.</span>
<span class="linecomment">;;     bookmark-default-handler: Pass the bookmark too as an arg to bmkp-goto-position.</span>
<span class="linecomment">;;     bookmark-relocate, bookmark-rename, bmkp-bmenu-list-1, bmkp-remove(-all)-tags, bmkp-add-tags:</span>
<span class="linecomment">;;       Add 0 as FRAME arg to get-buffer-window.</span>
<span class="linecomment">;;     bookmark-delete: Remove any highlighting on bookmark.</span>
<span class="linecomment">;;     bmkp-bmenu-list-1: Add highlight-overrides indicator.</span>
<span class="linecomment">;;     bmkp-completing-read-1: Added (not laxp) guard for first branch of main if.</span>
<span class="linecomment">;;     bmkp-crosshairs-highlight: Assign a priority.  Make the cmd a no-op for Emacs 20-21.</span>
<span class="linecomment">;;     bmkp-choose-navlist-*, bmkp-navlist-bmenu-list, bmkp-jump-in-navlist*,</span>
<span class="linecomment">;;       bmkp-cycle(-this-buffer*):</span>
<span class="linecomment">;;         Set bmkp-current-nav-bookmark to bookmark, not to its name.</span>
<span class="linecomment">;;     bmkp-update-autonamed-bookmark: Do not set bmkp-current-nav-bookmark to the name.</span>
<span class="linecomment">;;                                     Call bmkp-refresh-menu-list even if menu list is not displayed.</span>
<span class="linecomment">;;                                     Pass the bookmark name to bmkp-refresh-menu-list.</span>
<span class="linecomment">;;                                     Return the updated BOOKMARK.</span>
<span class="linecomment">;;     bmkp-refresh-menu-list: Set window point also.</span>
<span class="linecomment">;;     bmkp-goto-position:</span>
<span class="linecomment">;;       Added BOOKMARK arg.  When bmkp-save-new-location-flag, update BOOKMARK.  Return indicator.</span>
<span class="linecomment">;;     bmkp-create-varlist-bookmark: Call bookmark-set with INTERACTIVEP arg.</span>
<span class="linecomment">;;     bmkp-cycle(-this-buffer*): Added STARTOVERP arg. Pass OTHER-WINDOW, STARTOVERP to bmkp-cycle-1.</span>
<span class="linecomment">;;     bmkp-cycle-1: Added STARTOVERP arg.  If non-nil pop-up-frames, then inhibit showing annotation.</span>
<span class="linecomment">;;                   Use region only if bmkp-use-region value is cycling-too.</span>
<span class="linecomment">;;                   Use eq for *-list-position test.  If *-list-position returns nil, then reset.</span>
<span class="linecomment">;;                   Use save-selected-window, unlesl OTHER-WINDOW.</span>
<span class="linecomment">;;     bmkp-(next|previous)-bookmark(-this-buffer|-w32): Added STARTOVERP arg.  C-u: start over at 1.</span>
<span class="linecomment">;;     Bind highlight cmds: *-map: h,H,u,U,C-u,=,C-up|down.  *-bmenu-*map: H+,H&gt;+,H&gt;H,HH,HS,H&gt;U,HU.</span>
<span class="linecomment">;;                          *-jump-map: h.  Bind TS in *-bmenu-*map.</span>
<span class="linecomment">;;     Add bmkp-occur-create-autonamed-bookmarks to occur-mode-map as C-c b.</span>
<span class="linecomment">;;     Menus: Added Highlight, Toggle Option.  Added light to Jump To, Show, Mark, mouse.  Reorder.</span>
<span class="linecomment">;; 2010/06/23 dadams</span>
<span class="linecomment">;;     Split the change log off from file bookmark+-doc.el to new file bookmark+-chg.el.</span>
<span class="linecomment">;; 2010/06/21 dadams</span>
<span class="linecomment">;;     Renamed: bmkp-toggle-autoname-bookmark-set/delete to bmkp-toggle-autonamed-bookmark-set/delete,</span>
<span class="linecomment">;;              bmkp-autonamed-bookmarks-alist-only to bmkp-autonamed-this-buffer-alist-only,</span>
<span class="linecomment">;;              bmkp-bookmark-autoname-p to bmkp-autonamed-bookmark-for-buffer-p,</span>
<span class="linecomment">;;     Added: bmkp-autonamed-alist-only, bmkp-non-autonamed-alist-only, bmkp-autonamed-bookmark-p, </span>
<span class="linecomment">;;     bmkp-completing-read-1: Use DEFAULT as default.  Use just (not lax) - no non-t.</span>
<span class="linecomment">;;                             Use DEFAULT if empty input only if DEFAULT is non-nil.</span>
<span class="linecomment">;;     bmkp-choose-navlist-of-type: Added pseudo-type "any".</span>
<span class="linecomment">;;     bmkp-specific-buffers-alist-only: Exclude desktop etc. bookmarks.</span>
<span class="linecomment">;;     bmkp-update-autonamed-bookmark: Arg can be a bookmark (not just name).</span>
<span class="linecomment">;; 2010/06/19 dadams</span>
<span class="linecomment">;;     RENAMED bookmarkp* TO bmkp*.  ***** THIS IS AN INCOMPATIBLE CHANGE ******</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;       If you have existing customizations, or if you have bookmarks that have the (internal) tag</span>
<span class="linecomment">;;       "bmkp-jump", then YOU MUST REPLACE occurrences of "bookmarkp" by "bmkp" EVERYWHERE.  This</span>
<span class="linecomment">;;       includes replacing occurrences in (1) your bookmarks file (bookmark-default-file), (2) your</span>
<span class="linecomment">;;       state file (bmkp-bmenu-state-file), and (3) your command file (bmkp-bmenu-commands-file).</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;     Changed *-bmenu-w32-open-select binding to M-o from M-v.</span>
<span class="linecomment">;; 2010/06/11 dadams</span>
<span class="linecomment">;;     Wrap all (require '* nil t) in condition-case.</span>
<span class="linecomment">;; 2010/06/07 dadams</span>
<span class="linecomment">;;     Fix deskstop bookmarks for Emacs &lt; 22.  Protect:</span>
<span class="linecomment">;;       *-release-lock with fboundp, *-buffer-args-list with boundp, *-dir with Emacs version #, </span>
<span class="linecomment">;; 2010/05/30 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-(next|previous)-bookmark-w32(-repeat).  Bound to C-x p (next|prior).</span>
<span class="linecomment">;; 2010/05/29 dadams</span>
<span class="linecomment">;;     *-bmenu-list, *-choose-navlist-from-bookmark-list, *-bmenu-define(-full-snapshot)-command,</span>
<span class="linecomment">;;       *-save-menu-list-state, -make-bookmark-list-record:</span>
<span class="linecomment">;;         Add/restore bookmarkp-bmenu-filter-pattern to/from state.</span>
<span class="linecomment">;;     *-jump-bookmark-list: Set bookmarkp-latest-bookmark-alist to  bookmark-alist.</span>
<span class="linecomment">;;     Reordered Bookmark menu and added items:</span>
<span class="linecomment">;;       Set Bookmark, Delete Autonamed Bookmark, Delete All Autonamed Bookmarks Here,</span>
<span class="linecomment">;;       Delete Bookmarks Here, Delete Bookmark, Rename Bookmark, Bookmark List for This Buffer,</span>
<span class="linecomment">;;       Bookmark List for Navlist, Set Navlist to Bookmarks of Type,</span>
<span class="linecomment">;;       Set Navlist from Bookmark-List Bookmark, Insert Bookmark Contents, Insert Bookmark Location.</span>
<span class="linecomment">;;     Added to Bookmark+ menu: Set Navlist *.</span>
<span class="linecomment">;;     Added to bookmarkp-bmenu-jump-menu: In Navigation List. </span>
<span class="linecomment">;;     Added :enable entries for menu items.</span>
<span class="linecomment">;;     Updated bookmark-bmenu-mode doc string for cycling, navlist, and options.</span>
<span class="linecomment">;;     Corrected bindings of bookmarkp-jump-in-navlist(-other-window).</span>
<span class="linecomment">;; 2010/05/26 dadams</span>
<span class="linecomment">;;     Added:</span>
<span class="linecomment">;;       bookmarkp-choose-navlist-(from-bookmark-list|of-type), bookmarkp-crosshairs-highlight,</span>
<span class="linecomment">;;       bookmarkp-cycle(-this-buffer)(-other-window), bookmarkp-delete-bookmarks, </span>
<span class="linecomment">;;       bookmarkp-jump-in-navlist(-other-window), bookmarkp-navlist-bmenu-list,</span>
<span class="linecomment">;;       bookmarkp-(next|previous)-bookmark(-this-buffer)(-repeat),</span>
<span class="linecomment">;;       bookmarkp-toggle-autoname-bookmark-set/delete, bookmarkp-autoname-bookmark(-function),</span>
<span class="linecomment">;;       bookmarkp-autonamed-bookmarks-alist-only, bookmarkp-autoname-format,</span>
<span class="linecomment">;;       bookmarkp-bookmark-autoname-p, bookmarkp-crosshairs-flag,</span>
<span class="linecomment">;;       bookmarkp-this-buffer-cycle-sort-comparer, bookmarkp-current-bookmark-list-state,</span>
<span class="linecomment">;;       bookmarkp-cycle-1, bookmarkp-list-position, bookmarkp-position-cp,</span>
<span class="linecomment">;;       bookmarkp-current-nav-bookmark, bookmarkp-cycle-this-buffer-buff, bookmarkp-nav-alist,</span>
<span class="linecomment">;;       bookmarkp-update-autonamed-bookmark, bookmarkp-delete-all-autonamed-for-this-buffer.</span>
<span class="linecomment">;;    Bound:</span>
<span class="linecomment">;;       bookmarkp-choose-navlist-from-bookmark-list, bookmark-insert-location,</span>
<span class="linecomment">;;       bookmarkp-navlist-bmenu-list, bookmarkp-choose-navlist-of-type, bookmarkp-delete-bookmarks,</span>
<span class="linecomment">;;       bookmarkp-toggle-autoname-bookmark-set/delete, bookmarkp-jump-in-navlist(-other-window),</span>
<span class="linecomment">;;       bookmarkp-(next|previous)-bookmark(-this-buffer)-repeat.</span>
<span class="linecomment">;;    bookmark--jump-via: Update the name and position of an autonamed bookmark.</span>
<span class="linecomment">;; 2010/05/22 dadams</span>
<span class="linecomment">;;     *-this-buffer-p: Return nil for bookmarks not really associated with a buffer.</span>
<span class="linecomment">;;     *-default-handler, *-goto-position: Forgot comma to eval file-name when no-such-file error.</span>
<span class="linecomment">;;     *-show-annotation: Bind buffer-read-only to nil for updating.</span>
<span class="linecomment">;; 2010/05/19 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-this-buffer-bmenu-list.  Bound to `C-x p .'.</span>
<span class="linecomment">;;     menu-bar-bookmark-map:</span>
<span class="linecomment">;;       Added bookmarkp-this-buffer-bmenu-list.  Added separators.</span>
<span class="linecomment">;;       Added vanilla items edit, write, load, to impose order.  Renamed item edit.</span>
<span class="linecomment">;; 2010/05/16 dadams</span>
<span class="linecomment">;;     bookmark-set: Quoted history arg.  Thx to S. Nemec.</span>
<span class="linecomment">;;     bookmarkp-bmenu-define-full-snapshot-command: Use quote comma, not quote, for *-specific-*.</span>
<span class="linecomment">;; 2010/05/15 dadams</span>
<span class="linecomment">;;     Replace *same-(buffer|file)-jump* by *specific-(buffers|files)-jump*: read multiple buff/files.</span>
<span class="linecomment">;;     Renamed: *same-(buffer|file)* to *-last-specific-(buffer|file)* for pred, alist, and var.</span>
<span class="linecomment">;;     Renamed: *same-(buffer|file)* to *specific-(buffer|file)* for hist, *types*, mark/show cmds.</span>
<span class="linecomment">;;     Renamed: *-selected-buffers-alist* to *-specific-buffers-alist*.</span>
<span class="linecomment">;;     Added: *-specific-files-alist*, *-(all|some)-tags(-regexp)-alist-only.</span>
<span class="linecomment">;;     *-completing-read-(buffer|file)-name: Use (buffer|file)-name-history, not *-same-*-history.</span>
<span class="linecomment">;;     *-read-tags-completing: Rewrote to correctly handle cons and string tags, error handling, etc.</span>
<span class="linecomment">;;     *-bmenu-(add|remove)-tags-*-marked: Error handling.</span>
<span class="linecomment">;;     *(all|some)-tags(-regexp)-jump*: Use *-(all|some)-tags(-regexp)-alist-only.</span>
<span class="linecomment">;; 2010/05/11 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-mark-same-(buffer|file)-bookmarks, bookmarkp-this-(buffer|file)-p,</span>
<span class="linecomment">;;            bookmarkp-this-(buffer|file)-alist-only, bookmarkp-bmenu-show-only-same-(buffer|file),</span>
<span class="linecomment">;;            bookmarkp-completing-read-(buffer|file)-name, bookmarkp-same-(buffer|file)-history,</span>
<span class="linecomment">;;            bookmarkp-(same|this)-(buffer|file)-alist-only, bookmarkp-last-same-(buffer|file),</span>
<span class="linecomment">;;            bookmarkp-(same|this)-(buffer|file)-jump(-other-window), bookmarkp-(buffer|file)-names,</span>
<span class="linecomment">;;            bookmarkp-same-(buffer|file)-as-last-p, bookmarkp-other-window-pop-to-flag,</span>
<span class="linecomment">;;            bookmarkp-select-buffer-other-window.</span>
<span class="linecomment">;;     Use bookmarkp-select-buffer-other-window instead of switch-to-buffer-other-window everywhere.</span>
<span class="linecomment">;;     Bound = (b|f) (M|S), C-x j (=|.) (b|f) to (same|current)-(buffer|file) commands.</span>
<span class="linecomment">;;     *-types-alist: Handle same-(buffer|file) too.</span>
<span class="linecomment">;;     *-bmenu-list, *-bmenu-define-full-snapshot-command, *-save-menu-list-state:</span>
<span class="linecomment">;;       Handle bookmarkp-last-same-(buffer|file) as part of state.</span>
<span class="linecomment">;; 2010/05/05 dadams</span>
<span class="linecomment">;;     bookmarkp-create-varlist-bookmark, bookmarkp-make-varlist-record:</span>
<span class="linecomment">;;       Added optional arg BUFFER-NAME.</span>
<span class="linecomment">;;     bookmark-alist: Corrected doc string wrt BUFFER-NAME and region context strings.</span>
<span class="linecomment">;; 2010/05/04 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-create-varlist-bookmark.</span>
<span class="linecomment">;;     bookmarkp-jump-varlist: If bookmark's buffer doesn't exist, use current buffer and show msg.</span>
<span class="linecomment">;; 2010/04/24 adams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-show-only-varlists, bookmarkp-set-restrictions-bookmark,</span>
<span class="linecomment">;;            bookmarkp-set-varlist-bookmark, bookmarkp-varlist-jump, bookmarkp-varlist,</span>
<span class="linecomment">;;            bookmarkp-jump-varlist, bookmarkp-make-varlist-record, bookmarkp-printable-p,</span>
<span class="linecomment">;;            bookmarkp-printable-vars+vals, bookmarkp-read-variables-completing,</span>
<span class="linecomment">;;            bookmarkp-read-variable, bookmarkp-varlist-alist-only, bookmarkp-varlist-bookmark-p,</span>
<span class="linecomment">;;            bookmarkp-varlist-history.</span>
<span class="linecomment">;;     Bound bookmarkp-bmenu-show-only-varlists to V S, bookmarkp-varlist-jump to C-x j v (and menu).</span>
<span class="linecomment">;;     *-types-alist: Added bookmarkp-varlist-history.</span>
<span class="linecomment">;;     *-bmenu-mode-status-help, *-bmenu-propertize-item, *-describe-bookmark: Handle varlist bmks.</span>
<span class="linecomment">;;     *-bmenu-w32-open-select: Changed binding to M-v from V.</span>
<span class="linecomment">;;     *-bmenu-mode: Updated doc string.</span>
<span class="linecomment">;; 2010/04/17 dadams</span>
<span class="linecomment">;;     bookmark-set: Numeric prefix arg means use all bookmarks as completion candidates.</span>
<span class="linecomment">;;                   Simplified the prompt.</span>
<span class="linecomment">;;     bookmarkp-completing-read-1:</span>
<span class="linecomment">;;       Use icicle-transform-multi-completion in icicle-delete-candidate-object</span>
<span class="linecomment">;;     Ensure loaded before byte-compile (put a require after provide).</span>
<span class="linecomment">;;     Move bookmarkp-replace-regexp-in-string before macro bookmarkp-define-sort-command (uses it).</span>
<span class="linecomment">;;     bookmarkp-bmenu-w32-open-with-mouse, bookmarkp-bmenu-mouse-3-menu:</span>
<span class="linecomment">;;       Use with-current-buffer, not save-excursion of set-buffer.</span>
<span class="linecomment">;;     bookmarkp-make-dired-record, bookmarkp-jump-dired: Use dolist, not mapcar (just side effect).</span>
<span class="linecomment">;;     bookmarkp-(some|all)-tags-jump(-other-window): Removed extraneous arg in error call.</span>
<span class="linecomment">;; 2010/04/16 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-completing-read-1, bookmarkp-completing-read-lax,</span>
<span class="linecomment">;;            bookmarkp-selected-buffers-alist-only.</span>
<span class="linecomment">;;     bookmark-set: Use bookmark-completing-read-lax w/ buffer's bookmarks, not read-from-minibuffer.</span>
<span class="linecomment">;;     bookmark-completing-read: Define using bookmarkp-completing-read-1.</span>
<span class="linecomment">;; 2010/04/09 dadams</span>
<span class="linecomment">;;     bookmarkp-edit-bookmark: Update dired-directory property along with filename property. </span>
<span class="linecomment">;; 2010/03/28 dadams</span>
<span class="linecomment">;;     bookmarkp-goto-position: Don't funcall bookmarkp-jump-display-function if it is nil.</span>
<span class="linecomment">;; 2010/03/28 dadams</span>
<span class="linecomment">;;     bookmark-default-handler: Don't funcall bookmarkp-jump-display-function if it is nil.</span>
<span class="linecomment">;; 2010/03/27 dadams</span>
<span class="linecomment">;;     Changed the customization group from bookmarkp to bookmark-plus.</span>
<span class="linecomment">;;     Moved doc and change history from bookmark+.el to this new file, bookmark+-doc.el.</span>
<span class="linecomment">;;     bookmarkp-commentary-button: Use bookmark+-doc.el, not bookmark+.el.</span>
<span class="linecomment">;; 2010/03/17 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-toggle-bookmark-set-refreshes, bookmarkp-refresh-latest-bookmark-list,</span>
<span class="linecomment">;;            bookmarkp-after-set-hook.</span>
<span class="linecomment">;; 2010/03/16 dadams</span>
<span class="linecomment">;;     Fixed parens placement (typo) for last change to define *-jump-woman for Emacs 20.</span>
<span class="linecomment">;; 2010/03/11 dadams</span>
<span class="linecomment">;;     Define bookmarkp-jump-woman also for Emacs 20 (just raise an error).</span>
<span class="linecomment">;;     *-show-annotation: Typo: bookmark -&gt; bmk-name.</span>
<span class="linecomment">;; 2010/03/10 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bookmark-creation-cp, bookmarkp-bmenu-sort-by-creation-time (bind: s0, menu).</span>
<span class="linecomment">;;     *-make-record-default: Add entry: created.</span>
<span class="linecomment">;;     *-describe-bookmark: Add creation time to description.</span>
<span class="linecomment">;; 2010/03/03 dadams</span>
<span class="linecomment">;;     *-sort-and-remove-dups: Do not set bookmarkp-sorted-alist to the result.</span>
<span class="linecomment">;;     *-bmenu-list-1: Set bookmarkp-sorted-alist to the result of calling *-sort-and-remove-dups.</span>
<span class="linecomment">;; 2010/03/02 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-sorted-alist.</span>
<span class="linecomment">;;     *-bmenu-list-1: Use bookmarkp-sorted-alist.</span>
<span class="linecomment">;;     *-sort-and-remove-dups: Set bookmarkp-sorted-alist to the result.</span>
<span class="linecomment">;;     All *-cp (and hence *-define-file-sort-predicate):</span>
<span class="linecomment">;;       Accept bookmark names as args, in addition to bookmarks.</span>
<span class="linecomment">;;     bookmark-alpha-p: Don't use bookmarkp-make-plain-predicate, to avoid infinite recursion.</span>
<span class="linecomment">;; 2010/02/28 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-send-bug-report.</span>
<span class="linecomment">;;     bookmarkp-bmenu-mode-status-help: Rewrote to provide only Bookmark+ help.  Added help buttons.</span>
<span class="linecomment">;;     Fixed Commentary typos.</span>
<span class="linecomment">;; 2010/02/26 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-desktop-change-dir, bookmarkp-desktop-kill, bookmarkp-desktop-delete.</span>
<span class="linecomment">;;     *-jump-desktop: Call *-desktop-change-dir.</span>
<span class="linecomment">;;     *-read-bookmark-for-type: Added optional arg ACTION.</span>
<span class="linecomment">;; 2010/02/24 dadams</span>
<span class="linecomment">;;     *-bmenu-list: Handle case null last-bookmark-file (due to old file format).  Thx to Seb Luque.</span>
<span class="linecomment">;;     *-make-record-default: protect dired-buffers with boundp.  Thx to Janek Schwarz.</span>
<span class="linecomment">;; 2010/02/16 dadams</span>
<span class="linecomment">;;     bookmarkp-define-sort-command: Add msg suffix about repeating.</span>
<span class="linecomment">;;     bookmarkp-msg-about-sort-order: Added optional arg SUFFIX-MSG.</span>
<span class="linecomment">;; 2010/02/15 dadams</span>
<span class="linecomment">;;     Added: bookmark-bmenu-switch-other-window (redefinition for Emacs 20-22).</span>
<span class="linecomment">;;     *-bmenu-mode: Added redefinition, instead of advising.</span>
<span class="linecomment">;;     *-send-edited-annotation, *-relocate, *-rename, *-bmenu-refresh-menu-list,</span>
<span class="linecomment">;;       *-remove(-all)-tags, *-add-tags:</span>
<span class="linecomment">;;         Refresh the menu list, to pick up changes.</span>
<span class="linecomment">;;     *-refresh-menu-list: Added optional arg BOOKMARK: go to it.</span>
<span class="linecomment">;;     Do not bind bookmark-bmenu-relocate unless it's defined.</span>
<span class="linecomment">;;     *-handler-cp: Respect case-fold-search.</span>
<span class="linecomment">;; 2010/02/14 dadams</span>
<span class="linecomment">;;     Renamed bookmark-bmenu-list-1 to bookmarkp-bmenu-list-1.</span>
<span class="linecomment">;;     Added faces: bookmarkp-(a|t|&gt;|D)-mark, bookmarkp-heading (don't use bookmark-menu-heading).</span>
<span class="linecomment">;;     Added redefinitions: bookmark-send-edited-annotation, bookmark(-bmenu)-show-annotation,</span>
<span class="linecomment">;;                          bookmark-show-all-annotations.</span>
<span class="linecomment">;;     *-bmenu-mark, *-bmenu-delete, *-bmenu-list-1: Add faces to marks.</span>
<span class="linecomment">;;     *-bmenu-list-1 and everywhere: Get rid of "% " before menu-list title.</span>
<span class="linecomment">;;     *-bmenu-list-1: Use "a", not "*", as annotation mark.</span>
<span class="linecomment">;;                     Add "t" mark for tags.  Add an extra space before bookmark name.</span>
<span class="linecomment">;;     *-bmenu-marks-width: change value from 2 to 4, for the tags column and the extra space.</span>
<span class="linecomment">;; 2010/02/13 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-desktop-history,</span>
<span class="linecomment">;;            bookmarkp-desktop-jump (bound to C-x j K; added to menu),</span>
<span class="linecomment">;;            bookmarkp-bookmark-list-jump (bound to C-x j B; added to menu),</span>
<span class="linecomment">;;            bookmarkp-bookmark-list-alist-only, bookmarkp-bookmark-list-history.</span>
<span class="linecomment">;;     *-types-alist: Added entries for desktops and bookmark-lists.</span>
<span class="linecomment">;;     *-describe-bookmark: Added optional arg, to show full (internal) info.</span>
<span class="linecomment">;;                          Bind it to ? in bookmark-map.</span>
<span class="linecomment">;;     *-jump-bookmark-list: Pop to the bookmark-list (to show it).</span>
<span class="linecomment">;;     *-bmenu-mark-w3m-bookmarks: Typo: wrong predicate.</span>
<span class="linecomment">;;     *(-bmenu)-remove-all-tags: Raise error if no tags to remove.</span>
<span class="linecomment">;;     *-bmenu-remove-all-tags: Require confirmation if interactive.</span>
<span class="linecomment">;;     *-bmenu-remove-tags: Added optional arg MSGP.</span>
<span class="linecomment">;;     Menus: Added "..." as needed.</span>
<span class="linecomment">;;     *-bmenu-mouse-3-menu: Guard bookmark-bmenu-relocate with fboundp.</span>
<span class="linecomment">;; 2010/02/12 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-define-jump-marked-command.  Bound to M-c and added to menu.</span>
<span class="linecomment">;;     Changed bookmarkp-toggle-saving-bookmark-file binding to M-~ (M-s conflicts w isearch-multi).</span>
<span class="linecomment">;;     Updated bookmark-bmenu-mode doc string.</span>
<span class="linecomment">;; 2010/02/11 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-types-alist,</span>
<span class="linecomment">;;            bookmarkp-(dired|gnus|info|man|region|w3m|(non-|local-|remote-)file)-history.</span>
<span class="linecomment">;;     bookmark-completing-read: Added optional HIST arg.</span>
<span class="linecomment">;;     *-(relocate|rename|insert(-location)): Added bookmark default for interactive use.</span>
<span class="linecomment">;;     *-jump-dired: Handle bookmarkp-jump-display-function.</span>
<span class="linecomment">;;     *-read-bookmark-for-type: Added optional HIST arg.</span>
<span class="linecomment">;;     *-jump-to-type(-other-window),</span>
<span class="linecomment">;;       *-(dired|file|gnus|info|man|region|w3m|(local-|non-|remote-)file)-jump*(-other-window):</span>
<span class="linecomment">;;         Use type-specific history var.</span>
<span class="linecomment">;; 2010/02/09 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-get-tag-value.</span>
<span class="linecomment">;;     bookmark--jump-via: Handle special bookmark tag bookmarkp-jump.</span>
<span class="linecomment">;; 2010/02/08 dadams</span>
<span class="linecomment">;;     Renamed: bookmarkp-bmenu-dired-marked-local to bookmarkp-bmenu-dired-marked.</span>
<span class="linecomment">;;     bookmarkp-bmenu-dired-marked: Handle remote bookmarks if Emacs &gt; 23.1.</span>
<span class="linecomment">;;     Support tags with values.</span>
<span class="linecomment">;;       Added: bookmarkp-tag-name, bookmarkp-full-tag, bookmarkp(-bmenu)-set-tag-value.</span>
<span class="linecomment">;;       Renamed variable (not fn) bookmarkp-tags-list to bookmarkp-tags-alist.</span>
<span class="linecomment">;;       Use bookmarkp-full-tag everywhere for tag completion.</span>
<span class="linecomment">;;       *-has-tag-p: Use assoc-default, not member.</span>
<span class="linecomment">;;       *-read-tag(s)-completing: CANDIDATE-TAGS is now an alist.</span>
<span class="linecomment">;;       *-list-all-tags: Added optional arg FULLP (prefix arg).</span>
<span class="linecomment">;;       *-tags-list: Added optional arg NAMES-ONLY-P.</span>
<span class="linecomment">;;       *-(add|remove|rename)-tags: Use copy-alist, not copy-sequence.  Alist, not list, membership.</span>
<span class="linecomment">;;       *-rename-tag: Raise error if no tag with old name.</span>
<span class="linecomment">;;       *-bmenu-mark-bookmarks-tagged-regexp, *-regexp-filtered-tags-alist-only, *-describe-bookmark,</span>
<span class="linecomment">;;         *-(all|some)-tags-regexp-jump(-other-window):</span>
<span class="linecomment">;;           Use bookmarkp-tag-name.</span>
<span class="linecomment">;;       *-bmenu-mark/unmark-bookmarks-tagged-(all|some)/(none|not-all), *-define-tags-sort-command:</span>
<span class="linecomment">;;         Use assoc-default, not member.</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-add-tags, bookmarkp-bmenu-remove(-all)-tags.</span>
<span class="linecomment">;;     *-bmenu-mouse-3-menu: Use bookmarkp-bmenu-add-tags, bookmarkp-bmenu-remove(-all)-tags.</span>
<span class="linecomment">;;                           Added bookmarkp-bmenu-set-tag-value.</span>
<span class="linecomment">;;     *-bmenu-mark-bookmarks-satisfying: Made it a command (interactive).</span>
<span class="linecomment">;; 2010/02/07 dadams</span>
<span class="linecomment">;;     *-write-file: Corrected handling of ALT-MSG.</span>
<span class="linecomment">;;     Cleanup.</span>
<span class="linecomment">;;       *-remove-tags: Don't call *-get-tags twice.</span>
<span class="linecomment">;;       *-bmenu-(un)mark-bookmarks-tagged(-not)-(all|none|some):</span>
<span class="linecomment">;;         Don't duplicate what bookmarkp-read-tags-completing does.</span>
<span class="linecomment">;;       *-add-tags, *-remove-tags(-from-all): TAGS arg must be a list from the beginning.</span>
<span class="linecomment">;;       *-remove-tags-from-all, *-rename-tag: Use bookmark-all-names - don't mapcar car over alist.</span>
<span class="linecomment">;;       *-all-tags-regexp-jump: Corrected to use same pred as *-all-tags-regexp-jump-other-window.</span>
<span class="linecomment">;;       *-(some|all)-tags-jump(-other-window): Use bookmarkp-has-tag-p - don't repeat the definition.</span>
<span class="linecomment">;;       *-read-tag(s)-completing: Removed unnecessary or.</span>
<span class="linecomment">;; 2010/02/06 dadams</span>
<span class="linecomment">;;     *-write-file, *-empty-file: Corrected handling of ALT-MSG.</span>
<span class="linecomment">;; 2010/02/05 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-same-file-p, bookmarkp-empty-file.</span>
<span class="linecomment">;;     Bound bookmarkp-empty-file to C-x p 0, and added it to menus.</span>
<span class="linecomment">;;     *-bmenu-list, *-switch-bookmark-file: Use bookmarkp-same-file-p.</span>
<span class="linecomment">;;     bookmark-write-file: Added optional ALT-MSG arg.</span>
<span class="linecomment">;; 2010/02/04 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-omit, bookmarkp-list-all-tags.  Added to mouse-3 menu, Tags menus.</span>
<span class="linecomment">;; 2010/02/01 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-current-bookmark-file, bookmarkp-switch-bookmark-file,</span>
<span class="linecomment">;;            (redefinition of) bookmark-load, (redefinition of) bookmark-save,</span>
<span class="linecomment">;;            bookmarkp-toggle-saving-bookmark-file, bookmarkp-last-save-flag-value.</span>
<span class="linecomment">;;     *-bmenu-list: Restore bookmarkp-current-bookmark-file if appropriate.</span>
<span class="linecomment">;;     *-bmenu-mode-status-help: Show bookmarkp-current-bookmark-file.</span>
<span class="linecomment">;;     *-bmenu-define-full-snapshot-command, *-save-menu-list-state:</span>
<span class="linecomment">;;       Save bookmarkp-current-bookmark-file.</span>
<span class="linecomment">;;     Bound bookmarkp-switch-bookmark-file to L and C-x r L.  Added both load commands to both menus.</span>
<span class="linecomment">;;     *-toggle-saving-menu-list-state: Changed binding to M-l.  Error if init value is nil.</span>
<span class="linecomment">;;     Bound *-toggle-saving-bookmark-file to M-s and added to menu.</span>
<span class="linecomment">;;     Added bookmark-write to bookmarkp-bmenu-menubar-menu (Save As).</span>
<span class="linecomment">;;     bookmarkp-bmenu-menubar-menu: Added :help strings everywhere.</span>
<span class="linecomment">;;     bookmarkp-bmenu-mode-status-help: Added face legend.</span>
<span class="linecomment">;; 2010/01/31 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-tags-list, bookmarkp-read-tag-completing, bookmarkp-use-w32-browser-p,</span>
<span class="linecomment">;;            bookmarkp-bmenu-w32-open(-select|-with-mouse).  Bind *-w32* to M-RET, V, M-mouse-2.</span>
<span class="linecomment">;;     *-default-handler: Call w32-browser if bookmarkp-use-w32-browser-p.</span>
<span class="linecomment">;;     *-bmenu-unomit-marked: Don't try to return to original position (duh).</span>
<span class="linecomment">;;     *-bmenu-goto-bookmark-named: Use eobp as loop condition.  Call bookmark-bmenu-ensure-position.</span>
<span class="linecomment">;;     *-read-tags-completing:</span>
<span class="linecomment">;;       Added arg UPDATE-TAGS-LIST-P.  Call bookmark-maybe-load-default-file.</span>
<span class="linecomment">;;       Use bookmarkp-tags-list if CANDIDATE-TAGS is nil.  Update that var if UPDATE-TAGS-LIST-P.</span>
<span class="linecomment">;;     *-(add|remove)-tags: Added arg NO-CACHE-UPDATE-P.  If nil, call bookmarkp-tags-list.</span>
<span class="linecomment">;;     *-remove-tags-from-all, *-rename-tag, *-bmenu-(add|remove)-tags-(to|from)-marked:</span>
<span class="linecomment">;;       Call bookmarkp-tags-list.</span>
<span class="linecomment">;;     *-remove-tags-from-all: Pass nil as tags arg to bookmarkp-read-tags-completing.</span>
<span class="linecomment">;;     *-rename-tag: Use bookmarkp-read-tag-completing, not read-string.</span>
<span class="linecomment">;; 2010/01/29 dadams</span>
<span class="linecomment">;;     bookmarkp-describe-bookmark: Handle desktop bookmarks specifically.</span>
<span class="linecomment">;;     Added: bookmarkp-menu-popup-max-length.</span>
<span class="linecomment">;;     bookmark-completing-read: Use bookmarkp-menu-popup-max-length.</span>
<span class="linecomment">;;     bookmarkp-bmenu-state-file: Added missing default value for const.</span>
<span class="linecomment">;;     Don't add jump-other entry to menu-bar-bookmark-map (just use Jump To submenu).</span>
<span class="linecomment">;; 2010/01/28 dadams</span>
<span class="linecomment">;;     bookmarkp-(all|some)-tags(-regexp)-jump(-other-window): Error if no bookmarks with the tags.</span>
<span class="linecomment">;;     bookmarkp-(all|some)-tags-jump(-other-window): Handle case where user enters no tags.</span>
<span class="linecomment">;;     Use :advertised-binding property for bookmark-jump(-other-window).</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-jump-menu.</span>
<span class="linecomment">;;     Added bookmarkp-bmenu-jump-menu to menu-bar-bookmark-map and bookmarkp-bmenu-menubar-menu.</span>
<span class="linecomment">;; 2010/01/27 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-every, bookmarkp-(all|some)-tags(-regexp)-jump(-other-window).</span>
<span class="linecomment">;; 2010/01/26 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-dired-marked-local.  Bound to M-d &gt;.</span>
<span class="linecomment">;; 2010/01/23 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-handler-cp, bookmarkp-desktop-no-save-vars, bookmarkp-set-desktop-bookmark,</span>
<span class="linecomment">;;            bookmarkp-make-desktop-record, bookmarkp-jump-desktop, bookmarkp-desktop-read,</span>
<span class="linecomment">;;            bookmarkp-desktop-alist-only, bookmarkp-desktop-bookmark-p,</span>
<span class="linecomment">;;            bookmarkp-bmenu-mark-desktop-bookmarks, bookmarkp-bmenu-show-only-desktops,</span>
<span class="linecomment">;;            face bookmarkp-desktop.</span>
<span class="linecomment">;;     bookmarkp-bmenu-sort-by-bookmark-type: Add bookmarkp-handler-cp to the list (last).</span>
<span class="linecomment">;;     bookmarkp-bmenu-propertize-item: Add face bookmarkp-desktop for desktop bookmarks.</span>
<span class="linecomment">;;     Bound: bookmarkp-set-desktop-bookmark to C-x p K, C-x r K,</span>
<span class="linecomment">;;            bookmarkp-bmenu-mark-desktop-bookmarks to K M (and Mark menu),</span>
<span class="linecomment">;;            bookmarkp-bmenu-show-only-desktops to K S (and Show menu).</span>
<span class="linecomment">;;     bookmark-bmenu-mode doc string: Updated for new commands.</span>
<span class="linecomment">;;     Added autoload cookies for all defcustoms.</span>
<span class="linecomment">;; 2010/01/20 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-mode-status-help.  Bound to C-h m, ?.</span>
<span class="linecomment">;; 2010/01/19 dadams</span>
<span class="linecomment">;;     bookmarkp-remote-file-bookmark-p: Include remote Dired bookmarks.  Thx to Simon Harrison.</span>
<span class="linecomment">;;     Added: bookmarkp-describe-bookmark-internals, bookmarkp-bmenu-describe-this+move-(down|up),</span>
<span class="linecomment">;;            defalias for list-bookmarks.</span>
<span class="linecomment">;;     bookmarkp-describe-bookmark: Reformatted help output.  Added more info about Dired bookmarks.</span>
<span class="linecomment">;;     bookmarkp-bmenu-describe-this-bookmark:</span>
<span class="linecomment">;;       C-u calls bookmarkp-describe-bookmark-internals.  Bound also to C-h C-RET.</span>
<span class="linecomment">;; 2010/01/18 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-dired-subdirs.</span>
<span class="linecomment">;;     bookmarkp-make-dired-record, bookmarkp-jump-dired: Handle inserted and hidden dirs.</span>
<span class="linecomment">;;     bookmarkp-jump-dired: Use expand-file-name, not concat.</span>
<span class="linecomment">;; 2010/01/17 dadams</span>
<span class="linecomment">;;     Added:</span>
<span class="linecomment">;;       bookmarkp-jump(-other-window)-map, bookmarkp-jump-1, bookmark-all-names (redefined),</span>
<span class="linecomment">;;       bookmarkp-read-bookmark-for-type, bookmarkp-dired-jump-current(-other-window),</span>
<span class="linecomment">;;       bookmarkp-(dired|(local-|remote-|non-)file|gnus|info|man|region|w3m)-jump(-other-window),</span>
<span class="linecomment">;;       bookmarkp-jump-to-type(-other-window).</span>
<span class="linecomment">;;     bookmark-jump(-other-window): Use bookmarkp-jump-1.</span>
<span class="linecomment">;;     bookmark-completing-read: Added optional args ALIST and PRED.</span>
<span class="linecomment">;;     bookmarkp-default-bookmark-name: Added optional arg ALIST.</span>
<span class="linecomment">;; 2010/01/14 dadams</span>
<span class="linecomment">;;     bookmark-bmenu-surreptitiously-rebuild-list: Put back save-excursion & save-window-excursion.</span>
<span class="linecomment">;; 2010/01/02 dadams</span>
<span class="linecomment">;;     Renamed *-bmenu-check-position to *-bmenu-ensure-position, per Emacs 23.2.  Added defalias.</span>
<span class="linecomment">;; 2010/01/01 dadams</span>
<span class="linecomment">;;     *-bmenu-(un)mark, *-bmenu-other-window, *-bmenu-rename: Call bookmark-bmenu-check-position.</span>
<span class="linecomment">;;     *-bmenu-delete: Don't call bookmark-bmenu-check-position again at end.</span>
<span class="linecomment">;;     *-bmenu-edit-bookmark: Call bookmark-bmenu-check-position at beginning, not end.</span>
<span class="linecomment">;; 2009/12/30 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-header-lines, bookmarkp-bmenu-marks-width.  Use everywhere.</span>
<span class="linecomment">;; 2009/12/29 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-make-bookmark-list-record, bookmarkp-jump-bookmark-list, face</span>
<span class="linecomment">;;            bookmarkp-bookmark-list.</span>
<span class="linecomment">;;     *-bmenu-propertize-item: Highlight bookmark-list bookmarks.</span>
<span class="linecomment">;;     *-bmenu-refresh-menu-list: Set bookmarkp-latest-bookmark-alist to refreshed list.</span>
<span class="linecomment">;;     Face *-local-directory: Made dark background version the inverse of light.</span>
<span class="linecomment">;;     *-bmenu-list-1: Use eq, not equal, test for bookmarkp-omitted-alist-only as filter fn.</span>
<span class="linecomment">;;     *-bmenu-define(-full-snapshot)-command: Include bookmarkp-bmenu-omitted-list in saved state.</span>
<span class="linecomment">;; 2009/12/26 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-omitted-list, bookmarkp-bmenu-show-only-omitted, bookmarkp-unomit-all,</span>
<span class="linecomment">;;            bookmarkp-bmenu-omit/unomit-marked, bookmarkp-bmenu-(un-)omit-marked,</span>
<span class="linecomment">;;            bookmarkp-omitted-alist-only.</span>
<span class="linecomment">;;            Bind *-bmenu-omit/unomit-marked, *-bmenu-show-only-omitted, *-unomit-all to O&gt;,OS,OU.</span>
<span class="linecomment">;;     Added omit/un-omit stuff to Bookmark+ menu.</span>
<span class="linecomment">;;     bookmarkp-remove-assoc-dups, bookmarkp-sort-and-remove-dups: Added optional arg OMIT.</span>
<span class="linecomment">;;     bookmark-delete: Update bookmarkp-bmenu-omitted-list.</span>
<span class="linecomment">;;     bookmarkp-save-menu-list-state, bookmark-bmenu-list:</span>
<span class="linecomment">;;       Save/restore bookmarkp-bmenu-omitted-list as part of state.</span>
<span class="linecomment">;;     bookmark-bmenu-list-1: Treat omitted list when bookmarkp-omitted-alist-only.</span>
<span class="linecomment">;;     bookmarkp-marked-bookmark-p: Arg can now be a bookmark (or a bookmark name).</span>
<span class="linecomment">;;     bookmarkp-bmenu-unmark-all: Start by going forward 2 lines, not 1, if user hit RET.</span>
<span class="linecomment">;;     bookmarkp-bmenu-make-sequence-from-marked:</span>
<span class="linecomment">;;       Added optional arg DONT-OMIT-P.  If nil, omit marked bookmarks.</span>
<span class="linecomment">;;       If the seq bookmark already exists, prompt to add to it or replace it.</span>
<span class="linecomment">;;       Go to the new bookmark in the menu list.</span>
<span class="linecomment">;; 2009/12/15 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-sequence-jump-display-function, bookmarkp-sequence, bookmarkp-function,</span>
<span class="linecomment">;;            bookmarkp-bmenu-make-sequence-from-marked, bookmarkp-jump-sequence,</span>
<span class="linecomment">;;            bookmarkp-sequence-bookmark-p, bookmarkp-make-function-bookmark,</span>
<span class="linecomment">;;            bookmarkp-jump-function, bookmarkp-function-bookmark-p.</span>
<span class="linecomment">;;     bookmarkp-describe-bookmark: Update for sequence and function bookmarks.</span>
<span class="linecomment">;;     bookmark-bmenu-list: Use condition-case when read from bookmarkp-bmenu-state-file.</span>
<span class="linecomment">;;                          Bind emacs-lisp-mode-hook to nil.</span>
<span class="linecomment">;;     bookmark-bmenu-surreptitiously-rebuild-list: Use save-current-buffer.</span>
<span class="linecomment">;;     bookmarkp-bmenu-propertize-item: Add faces to function and sequence bookmarks.</span>
<span class="linecomment">;;     bookmarkp-bmenu-menubar-menu: Add *-make-sequence-*-from-marked, *-make-function-bookmark.</span>
<span class="linecomment">;;     bookmark--jump-via: Call *-record-visit with BATCH arg, to preserver point in menu list.</span>
<span class="linecomment">;;     bookmark-bmenu-list-1: fit-frame only if buffer is *Bookmark List*.</span>
<span class="linecomment">;; 2009/12/13 dadams</span>
<span class="linecomment">;;     *-alist-only: Call bookmark-maybe-load-default-file.</span>
<span class="linecomment">;; 2009/12/11 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-list-defuns-in-commands-file, bookmarkp-remove-dups.</span>
<span class="linecomment">;; 2009/12/06 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-mouse-3-menu (bound to mouse-3),</span>
<span class="linecomment">;;            bookmarkp-bmenu-(menubar|define-command|sort|show|tags|mark)-menu. </span>
<span class="linecomment">;;     bookmark-bmenu-delete: Remove newly flagged bookmark from bookmarkp-bookmark-marked-list.</span>
<span class="linecomment">;;     bookmarkp-define-tags-sort-command: Save macroexpanded definition in</span>
<span class="linecomment">;;                                         bookmarkp-bmenu-commands-file.</span>
<span class="linecomment">;; 2009/12/04 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-define-full-snapshot-command (bound to C),</span>
<span class="linecomment">;;            bookmarkp-define-tags-sort-command.</span>
<span class="linecomment">;;     bookmarkp-bmenu-mark-bookmarks-tagged-regexp: Removed extra forward-line if we mark line.</span>
<span class="linecomment">;; 2009/12/03 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-define-command (bound to c), bookmarkp-bmenu-commands-file.</span>
<span class="linecomment">;;     bookmark-bmenu-list: Read bookmarkp-bmenu-commands-file.</span>
<span class="linecomment">;;     bookmarkp-sort-and-remove-dups: Bug fix - return the list even when null sort function.</span>
<span class="linecomment">;; 2009/11/01 dadams</span>
<span class="linecomment">;;     Added: *-bmenu-check-position (redefinition), bmkext-jump-* defaliases.</span>
<span class="linecomment">;;     *-(w3m|man|gnus)-bookmark-p: Recognize the aliases.</span>
<span class="linecomment">;;     *-jump-man: Bind Man-notify-method.</span>
<span class="linecomment">;;     *-bmenu-goto-bookmark-named: Check the text property, instead of searching.</span>
<span class="linecomment">;;     *-bmenu-bookmark: Wrap in condition-case.</span>
<span class="linecomment">;; 2009/10/31 dadams</span>
<span class="linecomment">;;     Added: bookmark-bmenu-list-1. bookmarkp-toggle-saving-menu-list-state (C-t),</span>
<span class="linecomment">;;            bookmarkp-bmenu-state-file, bookmarkp-bmenu-first-time-p,</span>
<span class="linecomment">;;            bookmarkp-last-bmenu-(bookmark|state-file), bookmark-exit-hook-internal</span>
<span class="linecomment">;;            (redefinition), bookmarkp-save-menu-list-state.</span>
<span class="linecomment">;;     bookmark-bmenu-list: Restore menu-list state if appropriate.  Call bookmark-bmenu-list-1.</span>
<span class="linecomment">;;     bookmarkp-bmenu-quit: If *-bmenu-state-file is non-nil, save the state.</span>
<span class="linecomment">;;     bookmark-write-file: Use case, not cond.</span>
<span class="linecomment">;;     bookmark-set: Use command name as default for man-page bookmark name.</span>
<span class="linecomment">;;     bookmark-delete: Update bookmarkp-latest-bookmark-alist.</span>
<span class="linecomment">;; 2009/10/28 dadams</span>
<span class="linecomment">;;     Renamed: bookmarkp-bookmark-marked-p to bookmarkp-marked-bookmark-p</span>
<span class="linecomment">;;              bookmarkp-bmenu-sort-by-gnus-thread to bookmarkp-bmenu-sort-by-Gnus-thread.</span>
<span class="linecomment">;;     Added: bookmarkp-man, bookmarkp-make-(wo)man-record, bookmarkp-jump-(wo)man,</span>
<span class="linecomment">;;            bookmarkp-man-bookmark-p, bookmarkp-bmenu-mark-man-bookmarks,</span>
<span class="linecomment">;;            bookmarkp-bmenu-show-only-man-pages, bookmarkp-man-alist-only.</span>
<span class="linecomment">;;     *-bmenu-propertize-item: Handle (wo)man bookmarks.  Use bookmarkp-info-bookmark-p.</span>
<span class="linecomment">;;     *-regexp-filtered-*: Use bookmarkp-remove-if-not.</span>
<span class="linecomment">;;     *-write-file: Remove text properties from file name also.</span>
<span class="linecomment">;;     *-regexp-filtered-(tags|(bookmark|file)-name)-alist-only: Use *-remove-if-not.</span>
<span class="linecomment">;; 2009/10/26 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-mark-*-bookmarks, bmenu-mark-bookmarks-satisfying.</span>
<span class="linecomment">;;     Bound those and *-show-only-* accordingly.</span>
<span class="linecomment">;;     bookmarkp-file-alist-only: Redefined to just use *-file-bookmark-p.</span>
<span class="linecomment">;; 2009/10/25 dadams</span>
<span class="linecomment">;;     bookmarkp-bmenu-propertize-item: Put bookmark name on line as text property.</span>
<span class="linecomment">;;     bookmark-bmenu-bookmark: Get bookmark name from text property bookmarkp-bookmark-name.</span>
<span class="linecomment">;;     Removed: bookmarkp-latest-sorted-alist.</span>
<span class="linecomment">;;     bookmark-bmenu-list: Use bookmarkp-bmenu-title only if defined.</span>
<span class="linecomment">;; 2009/10/21 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-barf-if-not-in-menu-list.  Use in place of its body.</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-mark-bookmarks-tagged-regexp.  Bound to T m %.</span>
<span class="linecomment">;;     Added: bookmarkp-record-visit.  Use in *--jump-via.  Replaces next two removals.</span>
<span class="linecomment">;;     Removed: bookmarkp-add-or-update-time, bookmarkp-increment-visits.</span>
<span class="linecomment">;;     Renamed: *-record-(end|front|rear)-context(-region)-string'.</span>
<span class="linecomment">;;              New names: bookmarkp-(end-)position-(pre|post)-context(-region).</span>
<span class="linecomment">;;     *-bmenu-describe-this-bookmark: Added *-barf-if-not-in-menu-list.</span>
<span class="linecomment">;;     *-bmenu-(un)mark-all, *-bmenu-regexp-mark, *-bmenu-toggle-marks:</span>
<span class="linecomment">;;       Removed with-current-buffer.</span>
<span class="linecomment">;; 2009/10/20 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-filter-function, bookmarkp-bmenu-title.</span>
<span class="linecomment">;;     Removed: bookmarkp-bmenu-called-from-inside-p.</span>
<span class="linecomment">;;     *-bmenu-list:</span>
<span class="linecomment">;;       Removed TITLE arg.  Get title from bookmarkp-bmenu-title or default.</span>
<span class="linecomment">;;       Use interactive-p and absence of menu list, not *-bmenu-called-from-inside-p, as the</span>
<span class="linecomment">;;         criterion for removing marks.  Fixes bugs such as bookmark creation removing marks.</span>
<span class="linecomment">;;     *-define-sort-command, *-bmenu-execute-deletions, *-increment-visits,</span>
<span class="linecomment">;;       *-add-or-update-time, *-bmenu-show-only-*, *-bmenu-show-all,</span>
<span class="linecomment">;;       *-bmenu-refresh-menu-list, *-bmenu-toggle-show-only-(un)marked,</span>
<span class="linecomment">;;       *-bmenu-filter-alist-by-regexp, *-bmenu-reverse(-multi-sort)-order,</span>
<span class="linecomment">;;       *-bmenu-change-sort-order:</span>
<span class="linecomment">;;         Do not bind or set *-called-from-inside-p.</span>
<span class="linecomment">;;     *-bmenu-show-only-*, *-bmenu-show-all, *-bmenu-filter-alist-by-regexp:</span>
<span class="linecomment">;;       Set *-bmenu-filter-function, *-bmenu-title.</span>
<span class="linecomment">;;     *-bmenu-show-all:</span>
<span class="linecomment">;;       Set *-latest-bookmark-alist to bookmark-alist.</span>
<span class="linecomment">;;     *-bmenu-refresh-menu-list: Fix so that it in fact refreshes.</span>
<span class="linecomment">;;       Do not use *-bmenu-surreptitiously-rebuild-list and *-bmenu-check-position.</span>
<span class="linecomment">;;       Bind bookmark-alist to last alist (filtered or not), and call *-bmenu-list.</span>
<span class="linecomment">;;     *-bmenu-surreptitiously-rebuild-list:</span>
<span class="linecomment">;;       Do not use save*-excursion.  Do not get current title and pass it to *-bmenu-list.</span>
<span class="linecomment">;;     *-file-alist-only:</span>
<span class="linecomment">;;       Removed optional arg.  We have *-local-file-alist-only for that.</span>
<span class="linecomment">;;     *-regexp-filtered-alist-only, *-bmenu-filter-alist-by-regexp:</span>
<span class="linecomment">;;       Remove REGEXP arg - use bookmarkp-bmenu-filter-pattern.</span>
<span class="linecomment">;;     *-bmenu-filter-incrementally:</span>
<span class="linecomment">;;       Raise error if not in *Bookmark List*.</span>
<span class="linecomment">;;       Use just bookmarkp-bmenu-filter-alist-by-regexp in timer - pass no regexp arg.</span>
<span class="linecomment">;;     Added: bookmarkp-some, *-bmenu-filter-(file-name|tags)-incrementally,</span>
<span class="linecomment">;;            *-bmenu-filter-alist-by-(file-name|tags)-regexp,</span>
<span class="linecomment">;;            *-regexp-filtered-(file-name|tags)-alist-only.</span>
<span class="linecomment">;;     Renamed: *-bmenu-filter-incrementally to *-bmenu-filter-bookmark-name-incrementally,</span>
<span class="linecomment">;;              *-bmenu-filter-alist-by-regexp to *-bmenu-filter-alist-by-bookmark-name-regexp,</span>
<span class="linecomment">;;              *-regexp-filtered-alist-only to *-regexp-filtered-bookmark-name-alist-only.</span>
<span class="linecomment">;;     Bound these commands to P B, P F, and P T.  Updated bookmark-bmenu-mode doc string.</span>
<span class="linecomment">;; 2009/10/18 dadams</span>
<span class="linecomment">;;     Added: *-bmenu-filter-(incrementally|delay|prompt|pattern|timer|alist-by-regexp),</span>
<span class="linecomment">;;            *-bmenu-read-filter-input, *-regexp-filtered-alist-only,</span>
<span class="linecomment">;;            *-bmenu-cancel-incremental-filtering.</span>
<span class="linecomment">;;     *-bmenu-execute-deletions: Don't update menu list if this is a no-op.</span>
<span class="linecomment">;;     Updated Commentary.</span>
<span class="linecomment">;;     Thx to Thierry Volpiatto.</span>
<span class="linecomment">;;     Added: *-marked-cp, *-bmenu-sort-marked-before-unmarked.  Bound to s &gt;.</span>
<span class="linecomment">;;     *-define-sort-command: Use copy-sequence for default value.</span>
<span class="linecomment">;; 2009/10/17 dadams</span>
<span class="linecomment">;;     Added: *-read-tags-completing, *-set-union, *-tag-history, *-describe-bookmark,</span>
<span class="linecomment">;;            *-bmenu-describe-this-bookmark.  Bound *-bmenu-describe-this-bookmark to C-h RET.</span>
<span class="linecomment">;;     Use *-read-tags-completing instead of *-read-tags.</span>
<span class="linecomment">;;     *-sort-orders-for-cycling-alist: Use copy-sequence.</span>
<span class="linecomment">;;     *-bmenu-change-sort-order: Use member, not memq.</span>
<span class="linecomment">;;     *-get-bookmark: Handle case of non-string, non-cons. Document NOERROR in doc string.</span>
<span class="linecomment">;;     *-bmenu-execute-deletions: Fix so marks aren't removed if when delete.  Thx to Thierry.</span>
<span class="linecomment">;;     Convert recorded time to an Emacs time spec:</span>
<span class="linecomment">;;       *-make-record-default, -add-or-update-time: Use current-time, not bookmark-float-time.</span>
<span class="linecomment">;;       *-get-visit-time: Convert a deprecated time entry to an Emacs time spec.</span>
<span class="linecomment">;;       *-bookmark-last-access-cp: Convert recorded time to a number for comparison.</span>
<span class="linecomment">;;     Added: *-bmenu-show-filenames (redef of vanilla: put props on whole line, fit frame).</span>
<span class="linecomment">;;     Removed: old-bookmark-insert-location.</span>
<span class="linecomment">;;     *-insert-location: Do not call original.  Redefined: do not add text properties.</span>
<span class="linecomment">;;     *-bmenu-list, *-bmenu-hide-filenames: Put properties on line up to max width.</span>
<span class="linecomment">;;     *-bmenu-goto-bookmark-named: Allow trailing whitespace, since we use the whole line now.</span>
<span class="linecomment">;;     *-bmenu-list: Use pop-to-buffer, not switch-to-buffer.  Use do-list, not mapcar.</span>
<span class="linecomment">;;     *-bmenu-hide-filenames: fit-frame-if-one-window.</span>
<span class="linecomment">;;     *-bmenu-propertize-item: Better help-echo text.</span>
<span class="linecomment">;;     Updated bookmark-alist doc string to mention visits, time, and tags entries.</span>
<span class="linecomment">;; 2009/10/16 dadams</span>
<span class="linecomment">;;     Added tags feature.</span>
<span class="linecomment">;;       Added: *-(get|read)-tags, *-has-tag-p, *-remove(-all)-tags(-from-all),</span>
<span class="linecomment">;;              *-bmenu-remove-tags-from-marked, *-add-tags(-to-marked), *-rename-tag,</span>
<span class="linecomment">;;              *-bmenu-(un)mark-bookmarks-tagged-(all|none|some|not-all),</span>
<span class="linecomment">;;              *-bmenu-mark/unmark-bookmarks-tagged-(all/none|some/not-all).</span>
<span class="linecomment">;;       Bound to prefix key T.</span>
<span class="linecomment">;;       *-bmenu-mode: Updated doc string.</span>
<span class="linecomment">;;     Added: bookmarkp-default-bookmark-name.  Use as default instead of *-current-bookmark.</span>
<span class="linecomment">;;     Renamed: *-maybe-save-bookmark to *-maybe-save-bookmarks.</span>
<span class="linecomment">;;     Menu-list commands: Raise an error if command is used outside the menu list.</span>
<span class="linecomment">;; 2009/10/15 dadams</span>
<span class="linecomment">;;     Added: *-bmenu-(search|query-replace)-marked-bookmarks-regexp.  Bound to M-a, M-q.</span>
<span class="linecomment">;;     Renamed: *-non-marked-bookmarks-only to *-unmarked-bookmarks-only,</span>
<span class="linecomment">;;              *-bookmark-marked-alist to *-bmenu-marked-bookmarks.</span>
<span class="linecomment">;;     *-increment-visits, *-add-or-update-time:</span>
<span class="linecomment">;;       Set *-bmenu-called-from-inside-p to t, so we don't remove marks.</span>
<span class="linecomment">;;     Redefined *-bmenu-bookmark to get name from *-latest-sorted-alist.  Thx to Thierry V.</span>
<span class="linecomment">;;       *-bmenu-surreptitiously-rebuild-list, *-bmenu-list:</span>
<span class="linecomment">;;         Removed optional arg DONT-TOGGLE-FILENAMES-P.</span>
<span class="linecomment">;;       *-bmenu-execute-deletions, *-bmenu-toggle-show-only-(un)marked, *-bmenu-(un)mark-all,</span>
<span class="linecomment">;;         *-bmenu-regexp-mark, *-bmenu-toggle-marks:</span>
<span class="linecomment">;;           Do not bother with *-bmenu-toggle-filenames and rebuilding the menu list.</span>
<span class="linecomment">;; 2009/10/14 dadams</span>
<span class="linecomment">;;     Added: *-bmenu-delete (redefinition), *-isearch-bookmarks,</span>
<span class="linecomment">;;            *-bmenu-isearch(-marked)-bookmarks(-regexp), *-isearch-next-bookmark-buffer.</span>
<span class="linecomment">;;            Bound multi-isearch commands to M-s a C(-M)-s.</span>
<span class="linecomment">;; 2009/10/13 dadams</span>
<span class="linecomment">;;     Added: *-make-dired-record, *-jump-dired, *-dired-bookmark-p, *-dired-alist-only,</span>
<span class="linecomment">;;            *-bmenu-show-only-dired.  Bound *-bmenu-show-only-dired to M-d.</span>
<span class="linecomment">;;     bookmarkp-file-bookmark-p: Include bookmarks that have the Dired handler.</span>
<span class="linecomment">;;     Moved *-sort-orders-for-cycling-alist defcustoms after *-define-sort-command calls.</span>
<span class="linecomment">;;     Call bookmarkp-msg-about-sort-order only when interactive.</span>
<span class="linecomment">;;     *-add-or-update-time, *-increment-visits: Do not save each time we access a bookmark.</span>
<span class="linecomment">;;     Updated doc string of bookmark-alist and Commentary.</span>
<span class="linecomment">;; 2009/10/09 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-delete-marked.  Bound it to D.</span>
<span class="linecomment">;;            bookmarkp-sort-orders-for-cycling-alist.</span>
<span class="linecomment">;;     Renamed: bookmarkp-sort-functions-alist to bookmarkp-sort-orders-alist,</span>
<span class="linecomment">;;              bookmarkp-sort-function to bookmarkp-sort-comparer.</span>
<span class="linecomment">;;     bookmark-bmenu-execute-deletions: Added optional arg, for *-bmenu-delete-marked.</span>
<span class="linecomment">;;     *-sort-function: Changed default value to sorting by bookmark type (`s k').</span>
<span class="linecomment">;;     *-bmenu-change-sort-order: Use *-sort-orders-for-cycling-alist, not all sort orders.</span>
<span class="linecomment">;;     Updated Commentary and doc string (bookmark-bmenu-mode).</span>
<span class="linecomment">;; 2009/10/08 dadams</span>
<span class="linecomment">;;     Added: *-bmenu-sort-by-(w3m-url|gnus-thread), *-(gnus|w3m)-cp, *-cp-not,</span>
<span class="linecomment">;;            *-local-file-(accessed|updated)-more-recently-cp, *-bmenu-sort-by-bookmark-type.</span>
<span class="linecomment">;;     Renamed: *-bmenu-sort-by(-last)-file-(size|type|access|update) to</span>
<span class="linecomment">;;              *-bmenu-sort-by(-last)-local-file-(size|typeaccess|update),</span>
<span class="linecomment">;;              *-file-visited-more-recently-cp to *-local-file-accessed-more-recently-cp,</span>
<span class="linecomment">;;              *-file-(size|type)-cp to *-local-file-(size|type)-cp.</span>
<span class="linecomment">;;     Removed: *-file-(device|gid(-chg)|inode|last-(access|update|status-change)|links|modes</span>
<span class="linecomment">;;                            |uid)-cp.</span>
<span class="linecomment">;;     Bound *-bmenu-sort-by-bookmark-type to `s k'.</span>
<span class="linecomment">;;     *-define-file-sort-predicate: Use *-file-bookmark-p, not *-local-file-bookmark-p.</span>
<span class="linecomment">;;     *-msg-about-sort-order: Added optional arg PREFIX-ARG.  Use in: *-show-(all|only-*).</span>
<span class="linecomment">;; 2009/10/07 dadams</span>
<span class="linecomment">;;     Renamed: *-bmenu-sort-by-last-visit-time to *-bmenu-sort-by-last-bookmark-access,</span>
<span class="linecomment">;;              *-bmenu-sort-by-visit-frequency to *-bmenu-sort-by-bookmark-visit-frequency,</span>
<span class="linecomment">;;              *-visited-more-recently-cp to *-bookmark-last-access-cp.</span>
<span class="linecomment">;; 2009/10/06 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-msg-about-sort-order.</span>
<span class="linecomment">;;     bookmark-completing-read: Simple sort when use menu-bar menu.</span>
<span class="linecomment">;; 2009/10/05 dadams</span>
<span class="linecomment">;;     Added: *-make-plain-predicate, *-reverse-multi-sort-order, *-multi-sort,</span>
<span class="linecomment">;;            *-define-file-sort-predicate, *-bmenu-sort-by-file-*, *-file-attribute-*-cp,</span>
<span class="linecomment">;;            and aliases *-file-*-cp, *-current-sort-order.</span>
<span class="linecomment">;;     Redefined sorting to allow multi-predicates:</span>
<span class="linecomment">;;       Redefined: *-sort-function, *-sort-and-remove-dups, *-define-sort-command,</span>
<span class="linecomment">;;                  *-sort-functions-alist.</span>
<span class="linecomment">;;     Bound keys with `s f' prefix to file-sorting commands</span>
<span class="linecomment">;;     *-current-sort-order: Use rassoc instead of rassq now.</span>
<span class="linecomment">;;     Swap keys s and S.  S is now bookmark-bmenu-save.  s is not the sorting prefix key.</span>
<span class="linecomment">;;     bookmark-bmenu-mode: Mention S key explicitly here (even though it is also</span>
<span class="linecomment">;;                          mentioned in the vanilla part of the doc string).</span>
<span class="linecomment">;; 2009/10/04 dadams</span>
<span class="linecomment">;;     *-bmenu-change-sort-order-repeat: Require repeat.el.</span>
<span class="linecomment">;;     Renamed: bookmarkp-current-sec-time to bookmarkp-float-time.</span>
<span class="linecomment">;;     *-float-time: Added arg, so it's the same as float-time (for Emacs 20).</span>
<span class="linecomment">;;     Bind *-reverse-sort-order to `S R'.</span>
<span class="linecomment">;;     *-remote-file-bookmark-p: Removed extra rem-file in last and.</span>
<span class="linecomment">;;     *-non-file-bookmark-p: Ensure it's not a remote file, before calling file-exists-p.</span>
<span class="linecomment">;; 2009/10/03 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-file-remote-p, bookmarkp-buffer (face).</span>
<span class="linecomment">;;     bookmarkp-non-file (face): Changed to gray.</span>
<span class="linecomment">;;     *-default-handler, *-bmenu-propertize-item, *-(info|file)-bookmark-p:</span>
<span class="linecomment">;;       Support Emacs 20-21 Info-node bookmarks.</span>
<span class="linecomment">;;     bookmarkp-bmenu-propertize-item: Use different face for existing buffers.</span>
<span class="linecomment">;;                                      Use bookmarkp-non-file-filename.</span>
<span class="linecomment">;;     bookmarkp-non-file-bookmark-p: Include buffer bookmarks for nonexistent buffers.</span>
<span class="linecomment">;;     bookmarkp-remote-file-bookmark-p: Use bookmarkp-file-remote-p.</span>
<span class="linecomment">;;     bookmark-handle-bookmark:</span>
<span class="linecomment">;;       Redefine for all Emacs versions.  Handle buffer (non-file) bookmarks.</span>
<span class="linecomment">;;     Reordered some function definitions.</span>
<span class="linecomment">;; 2009/10/02 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-bmenu-goto-bookmark-named, bookmarkp-latest-sorted-alist.</span>
<span class="linecomment">;;     *-sort-and-remove-dups: Set *-latest-sorted-alist (not used yet).</span>
<span class="linecomment">;;     *-define-sort-command, *-bmenu-change-sort-order, *-reverse-sort-order:</span>
<span class="linecomment">;;       Bind *-bmenu-called-from-inside-p to t, to prevent losing marks.</span>
<span class="linecomment">;;       Restore cursor position to same bookmark after sorting - use *-goto-bookmark-named.</span>
<span class="linecomment">;;     *-bmenu-surreptitiously-rebuild-list, *-bmenu-list: Added arg DONT-TOGGLE-FILENAMES-P.</span>
<span class="linecomment">;;     *-bmenu-execute-deletions, *-bmenu-toggle-show-only-(un)marked:</span>
<span class="linecomment">;;       Call *-surreptitiously-* with arg DONT-TOGGLE-FILENAMES-P.</span>
<span class="linecomment">;;     *-bmenu-hide-filenames: Simplify - don't get to position by searching backward.</span>
<span class="linecomment">;;     *-handle-region-default: Use forward-line, not goto-line.</span>
<span class="linecomment">;;     Thx to Thierry V.</span>
<span class="linecomment">;; 2009/10/01 dadams</span>
<span class="linecomment">;;     Added: bookmarkp-some-unmarked-p.</span>
<span class="linecomment">;;     Renamed: *-bmenu-toggle-show-only-&lt;TYPE&gt; to *-bmenu-show-only-&lt;TYPE&gt;,</span>
<span class="linecomment">;;              *-bmenu-called-from-inside-flag to *-bmenu-called-from-inside-p.</span>
<span class="linecomment">;;     bookmarkp-some-marked-p: Do not test bookmarkp-bookmark-marked-alist.</span>
<span class="linecomment">;;                              Arg must be required (explicit).  Changed calls accordingly.</span>
<span class="linecomment">;;     bookmark-bmenu-mode: Cleaned up doc string.</span>
<span class="linecomment">;;     bookmark-bmenu-((un)mark|rename|edit-*|toggle-marks|surreptitiously-rebuild-list),</span>
<span class="linecomment">;;       bookmarkp-root-or-sudo-logged-p, bookmarkp-jump-w3m-(new-session|only-one-tab),</span>
<span class="linecomment">;;       bookmarkp-some-marked-p:</span>
<span class="linecomment">;;         Inline let vars used only once.</span>
<span class="linecomment">;;     bookmarkp-bmenu-toggle-show-only-marked:</span>
<span class="linecomment">;;       Test bookmarkp-some-unmarked-p, not bookmarkp-some-marked-p,</span>
<span class="linecomment">;;            and include *-before-hide-unmarked in the test.</span>
<span class="linecomment">;;     bookmarkp-bmenu(-toggle)-show-only-*: Display status message.</span>
<span class="linecomment">;;     bookmarkp-bmenu-toggle-show-only-(un)marked: Fit frame.</span>
<span class="linecomment">;;     bookmark-prop-set: Fixed, so it handles old bookmark format also.</span>
<span class="linecomment">;; 2009/10/01 Thierry Volpiatto</span>
<span class="linecomment">;;     Removed: bookmarkp-bmenu-restore-marks.</span>
<span class="linecomment">;;     bookmark-bmenu-list:</span>
<span class="linecomment">;;       Do the mark restoration in line, at the same time as the annotation * restoration.</span>
<span class="linecomment">;;       Simplify use of START and END.</span>
<span class="linecomment">;; 2009/09/30 dadams</span>
<span class="linecomment">;;     bookmarkp-bmenu-regexp-mark: Remove binding of bookmark-alist.</span>
<span class="linecomment">;;     bookmark-bmenu-(un)mark, bookmarkp-bmenu-edit-bookmark (remove first call only),</span>
<span class="linecomment">;;       bookmark-bmenu-other-window, bookmark-bmenu-rename, bookmarkp-bmenu-restore-marks:</span>
<span class="linecomment">;;         Remove bookmark-bmenu-check-position (done by bookmark-bmenu-bookmark anyway).</span>
<span class="linecomment">;;     bookmark-insert-location: Fix interactive spec for Emacs &lt; 22.</span>
<span class="linecomment">;;     bookmark-location: Return "" instead of raising error, if no location found.</span>
<span class="linecomment">;;     bookmarkp-current-sec-time: Move the let: do not call current-time unless we need to.</span>
<span class="linecomment">;;     bookmarkp-bmenu-unmark-all: forward-line only 1, not 2.  Thx to Thierry.</span>
<span class="linecomment">;;     bookmark-bmenu-mode: Updated doc string - bindings and mention options.</span>
<span class="linecomment">;;     bookmarkp-bmenu-propertize-item: For buffer, check also against "   - no file -".</span>
<span class="linecomment">;; 2009/09/29 dadams</span>
<span class="linecomment">;;     bookmark-bmenu-unmark: Use delete, not remove.</span>
<span class="linecomment">;;     Removed: bookmark-bmenu-check-position, bookmarkp-maybe-sort.</span>
<span class="linecomment">;;     Added: bookmarkp-sort-and-remove-dups, bookmarkp-remove-assoc-dups,</span>
<span class="linecomment">;;            bookmarkp-face-prop, bookmarkp-bad-bookmark, bookmark-menu-heading (Emacs 20,21),</span>
<span class="linecomment">;;            bookmark-bmenu-bookmark (redefinition).</span>
<span class="linecomment">;;     *-bmenu-toggle-show-only-*: Do not call-interactively.</span>
<span class="linecomment">;;     bookmarkp-bmenu-(un)mark-all:</span>
<span class="linecomment">;;       Handle bookmark-bmenu-toggle-filenames (wrapper).</span>
<span class="linecomment">;;       Remove bookmark-bmenu-check-position - just ensure within menu list.</span>
<span class="linecomment">;;     bookmarkp-bmenu-mark-all: Move save-excursion so it applies to all movements.</span>
<span class="linecomment">;;                               Message stating number marked.</span>
<span class="linecomment">;;     bookmarkp-bmenu-unmark-all: Use with-current-buffer ensure in menu list.</span>
<span class="linecomment">;;                                 Use bookmark-bmenu-unmark.</span>
<span class="linecomment">;;     Fixed U bindings for bookmarkp-bmenu-unmark-all.</span>
<span class="linecomment">;;     bookmarkp-bmenu-regexp-mark:</span>
<span class="linecomment">;;       Remove bookmark-bmenu-check-position - just ensure in menu list.</span>
<span class="linecomment">;;     bookmarkp-bmenu-toggle-marks: Use forward-line 2, to ensure in menu list.</span>
<span class="linecomment">;;                                   Message stating number marked.</span>
<span class="linecomment">;;     bookmark-bmenu-list, bookmarkp-bmenu-propertize-item: Use bookmarkp-face-prop.</span>
<span class="linecomment">;;     bookmark-bmenu-list: Don't start applying the faces until column 2.</span>
<span class="linecomment">;;     Removed key bindings in bookmark-map for *-toggle-show-only-*.</span>
<span class="linecomment">;;     Redefined faces, esp. for a light background.</span>
<span class="linecomment">;;     Use font-lock-face or face property, depending on Emacs version.</span>
<span class="linecomment">;;</span>
<span class="linecomment">;; 2009-06-09 to 2009-09-27 Thierry Volpiatto and dadams</span>
<span class="linecomment">;;     New features, as follows.</span>
<span class="linecomment">;;       See also the change log at</span>
<span class="linecomment">;;         http://mercurial.intuxication.org/hg/bookmark-icicle-region/.</span>
<span class="linecomment">;;       2090-09-27 Rewrote sorting and unmarking code.  (+ Updates to doc, names.)</span>
<span class="linecomment">;;                    Unmarking is now like Dired & query-replace.</span>
<span class="linecomment">;;                    Sorting is via one sort function; sort predicates do all the sorting.</span>
<span class="linecomment">;;                    Can now cycle sort orders with S S S...</span>
<span class="linecomment">;;                    Sort cmds now cycle among normal, reverse, off.</span>
<span class="linecomment">;;                    Add: *-define-sort-command (macro), *-assoc-delete-all, *-upcase,</span>
<span class="linecomment">;;                         *-get-visits-count, *-get-visit-time, *-sort-functions-alist.</span>
<span class="linecomment">;;                  Remove docstring from defalias (for Emacs 20).</span>
<span class="linecomment">;;       2009-09-26 Fix *-bmenu-mode doc (defadvice).</span>
<span class="linecomment">;;       2009-09-25 *-bmenu-edit, *-bmenu-sort-1: Fix bmk retrieval code.</span>
<span class="linecomment">;;                  Redefine *-bmenu-unmark.  Add: *-bmenu-toggle-marks.</span>
<span class="linecomment">;;                  Bind *-bmenu-unmark-all-bookmarks to M-DEL.  Reorder code.</span>
<span class="linecomment">;;                  Rename: *-bmenu-unmark-all-(bookmarks|(delete|mark)-flag)',</span>
<span class="linecomment">;;                          *-bmenu-unmark-all-bookmarks-1.</span>
<span class="linecomment">;;                  Change sort predicates in defalias.  Rename bmk entry visit to visits.</span>
<span class="linecomment">;;                  Remove: *-bmenu-show-number-of-visit.</span>
<span class="linecomment">;;       2009-09-22 Rewrote sorting code.  Renamed unmarking fns.</span>
<span class="linecomment">;;       2009-09-21 Rename mark/unmark cmds to have -bmenu.</span>
<span class="linecomment">;;                  Add: *-bmenu-called-from-inside-flag - set it in (un)hide marks fns.</span>
<span class="linecomment">;;       2009-09-20 *-write-file: Remove text properties before saving.</span>
<span class="linecomment">;;                  Remove all marks only in current display.</span>
<span class="linecomment">;;       2009-09-19 *-current-sec-time: Protect with fboundp for Emacs 20.</span>
<span class="linecomment">;;                  *-bmenu-sort-1: Add msg showing sort method.</span>
<span class="linecomment">;;                  Change key S-A to S-S (A is annotations).</span>
<span class="linecomment">;;       2009-09-18 Improve sorting by visit frequency.  Always increment when jump.</span>
<span class="linecomment">;;                  Fix increment visit fn.  Allow sorting by last visited.</span>
<span class="linecomment">;;                  When visit values are equal, sort with string-lessp.</span>
<span class="linecomment">;;                  Add TIME bookmark-alist entry.  *-make-record-default: Add time entry.</span>
<span class="linecomment">;;                  Fix: bad parens, errors in sorting predicate.  Rename fns.  </span>
<span class="linecomment">;;                  Use single fn to sort using diff methods.</span>
<span class="linecomment">;;                  Add: *-bmenu-refresh-alist (bind to g).</span>
<span class="linecomment">;;       2009-09-16 Add: *-toggle-sorting-by-most-visited, *-reset-visit-flag,</span>
<span class="linecomment">;;                       *-bmenu-show-number-of-visit.</span>
<span class="linecomment">;;                  Redefine *-prop-set.  Improve *-toggle-sorting-by-most-visited.</span>
<span class="linecomment">;;                  Add auto-doc to header.  *-bmenu-mode: Add missing key.</span>
<span class="linecomment">;;                  Update menu-list after jumping.</span>
<span class="linecomment">;;                  Increment save counter when jump with visit flag.</span>
<span class="linecomment">;;       2009-09-15 Record number of visits.  Added sorting by most visits.</span>
<span class="linecomment">;;       2009-09-14 Add doc string.  Update defadvice doc string wrt keys.</span>
<span class="linecomment">;;       2009-09-12 Add: fns to mark all, unmark D or &gt; or all, *-bmenu-reset-alist.</span>
<span class="linecomment">;;                  Fix keymap (Emacs 20).  *-unmark-all-bookmarks1: Move the save-excursion.</span>
<span class="linecomment">;;       2009-09-11 Add: *-bmenu-check-position (redef to improve performance),</span>
<span class="linecomment">;;                       *-unmark-all-bookmarks, *-current-list-have-marked-p,</span>
<span class="linecomment">;;                       *-bookmark-marked-p, *-(non-)marked-bookmarks-only.</span>
<span class="linecomment">;;                  *-bmenu-hide-unmarked: Add toggling.  Restore lost fn.</span>
<span class="linecomment">;;                  Reorder code.  Bind cmds in *-bmenu-mode-map.</span>
<span class="linecomment">;;                  *-bmenu-hide-marked: Do not hide if no marked in current filter.</span>
<span class="linecomment">;;                  Improve: *-bmenu-hide(-not)-marked-bookmark, (un)hide marked fns.</span>
<span class="linecomment">;;       2009-09-10 Fix *--restore-all-mark, *-bmenu-regexp-mark.</span>
<span class="linecomment">;;                  *-bmenu-list: Add *-restore-all-mark.</span>
<span class="linecomment">;;                  *-bmenu-mark: Push marked bmk to marked list.</span>
<span class="linecomment">;;                  Add: bookmarkp-bookmark-marked-list, *-bmenu-quit.</span>
<span class="linecomment">;;       2009-09-09 *-maybe-sort-alist: Use copy-sequence.</span>
<span class="linecomment">;;                  So remove fixes for *-rename, *-edit-bookmark.</span>
<span class="linecomment">;;                  *-yank, *-rename', *-set: Fix yanking.</span>
<span class="linecomment">;;                  Remove non-file bmks from file-only list.</span>
<span class="linecomment">;;                  Add: *-bmenu-list-only-non-file-bookmarks, *-maybe-message (Emacs 20),</span>
<span class="linecomment">;;                       *-bmenu-mark-bookmark-matching-regexp, *-bmenu-hide-marked-bookmark,</span>
<span class="linecomment">;;                       *-bmenu-hide-not-marked-bookmark, *-bmenu-mark (redefinition).</span>
<span class="linecomment">;;                  *-write-file: Improve performance.</span>
<span class="linecomment">;;                  *-non-file-alist-only: Remove unused def.</span>
<span class="linecomment">;;                  Fix: hide marked/unmarked with toggle-filenames, keymap for Emacs 20.</span>
<span class="linecomment">;;                  Improve comments, doc strings.</span>
<span class="linecomment">;;                  *-bmenu-mark-bookmark-matching-regexp: Fix while loop.</span>
<span class="linecomment">;;       2009-09-08 bookmark-store: Remove duplicate setq of *-current-bookmark.</span>
<span class="linecomment">;;       2009-09-07 Reorganize (reorder), add comments, improve doc strings.</span>
<span class="linecomment">;;                  Change binding of *-bmenu-relocate from R to M-r.</span>
<span class="linecomment">;;       2009-09-06 bookmark-rename: Redefine with new arg BATCH.</span>
<span class="linecomment">;;                  *-bmenu-rename: Go to new pos, not old.</span>
<span class="linecomment">;;                  *-edit-bookmark, bookmark-rename: Fix display update for Emacs 20.</span>
<span class="linecomment">;;       2009-09-05 Add: *-edit-bookmark, *-bmenu-edit-bookmark, *-maybe-save-bookmark.</span>
<span class="linecomment">;;       2009-09-04 Require cl.  Allow RET in Emacs 20.  Add doc string.</span>
<span class="linecomment">;;                  *-fix-bookmark-alist-and-save:</span>
<span class="linecomment">;;       2009-09-03 Fix *-fix-bookmark-alist-and-save:</span>
<span class="linecomment">;;                    Use error, not message.  Change value for setcdr.</span>
<span class="linecomment">;;                    Do not use push with non-var (cl).</span>
<span class="linecomment">;;                  bookmark-delete:</span>
<span class="linecomment">;;                    Redefine, to fix vanilla bug: increment count even when batch.</span>
<span class="linecomment">;;                  *-non-file-name: Change to - no file -.  *-bmenu-list: Add arg FILTER-ON.</span>
<span class="linecomment">;;                  *-bmenu-execute-deletions: Use delete, not remove.</span>
<span class="linecomment">;;                  Add: *-replace-regexp-in-string.</span>
<span class="linecomment">;;                  bookmark-set: Fix *-yank-point for region case.  Fix bad parens.</span>
<span class="linecomment">;;       2009-09-02 Add: *-non-file-filename.  *-fix-bookmark-alist-and-save: Fix msg.</span>
<span class="linecomment">;;                  Require cl (gensym).  *-at-bol/eol' -&gt; line-*-position (for Emacs 20).</span>
<span class="linecomment">;;                  bookmark-delete: increment *-count if batch arg (fixes vanilla bug).</span>
<span class="linecomment">;;                  Redefine *-bmenu-execute-deletions,</span>
<span class="linecomment">;;                           *-bmenu-surreptitiously-rebuild-list. </span>
<span class="linecomment">;;                  Update current filtered display - do not reload & display all bmks.</span>
<span class="linecomment">;;                  Add redefinitions of *-bmenu-rename', *-yank-word to fix vanilla bugs:</span>
<span class="linecomment">;;                    *-bmenu-rename: Do not call *-bmenu-list twice.</span>
<span class="linecomment">;;                  *-yank-word: Do not insert whitespace.</span>
<span class="linecomment">;;                  Rename *-last-bookmark-alist-in-use to *-latest-bookmark-alist.</span>
<span class="linecomment">;;       2009-09-01 Fix: Loading of new doc for bookmark-alist (add vacuous defvar).</span>
<span class="linecomment">;;                       *-bmenu-(list|hide-filenames): start -&gt; end, end -&gt; start.</span>
<span class="linecomment">;;                  Removed extraneous quote mark that caused problems.</span>
<span class="linecomment">;;                  Save only if condition-case exits OK.</span>
<span class="linecomment">;;       2009-08-31 Fixes: Test for non-file bmk.  Filename for Gnus bmks.</span>
<span class="linecomment">;;                         Compatibility of bookmark-alist with vanilla Emacs.</span>
<span class="linecomment">;;                         Require info.el and ffap.el when needed.</span>
<span class="linecomment">;;                  Add: *-line-number-at-pos (for Emacs 20),</span>
<span class="linecomment">;;                       *-bmenu-other-window (redefinition).</span>
<span class="linecomment">;;                  Rename *-propertize-bookmark-list to *-propertize-bmenu-item.</span>
<span class="linecomment">;;       2009-08-30 Fix: Increment *-alist-modification-count when relocate region,</span>
<span class="linecomment">;;                       and maybe save.</span>
<span class="linecomment">;;                  Move code adding properties to bookmarks out of *-bmenu-list.</span>
<span class="linecomment">;;                  mapc -&gt; mapcar.  *-bmenu-hide-filenames: Redefine.</span>
<span class="linecomment">;;       2009-08-29 Remove refresh code.</span>
<span class="linecomment">;;       2009-08-27 Added: *-local-directory-bookmark-p, *-local-file-alist-only,</span>
<span class="linecomment">;;                         *-non-file-alist-only.</span>
<span class="linecomment">;;                  *-file-bookmark-p: Redefined to exclude bmks with handlers.</span>
<span class="linecomment">;;                  Renamed fns and faces.</span>
<span class="linecomment">;;       2009-08-25 Fit frame after display menu list.</span>
<span class="linecomment">;;                  Refresh list when toggle filename visibility.</span>
<span class="linecomment">;;       2009-08-24 Fix: *-bmenu-list for remote files, bookmark-set, *-remote-file-bookmark-p.</span>
<span class="linecomment">;;                  Ensure arg to file-remote-p is not nil.</span>
<span class="linecomment">;;                  Recenter region only if it is visible.</span>
<span class="linecomment">;;       2009-08-23 Remove old *-location.  *-bmenu-list: Add isw3m.</span>
<span class="linecomment">;;                  bookmark-set:</span>
<span class="linecomment">;;                    Redefine for older Emacs. Use a default prompt for gnus, w3m.</span>
<span class="linecomment">;;                    Use *-name-length-max for title when region is active.</span>
<span class="linecomment">;;                    Ensure bookmark is on one line.</span>
<span class="linecomment">;;       2009-08-22 Try to handle tramp ftp files.</span>
<span class="linecomment">;;                  Do not fail if bookmark has empty filename entry.</span>
<span class="linecomment">;;                  Show region end pos using exchange-point-and-mark.</span>
<span class="linecomment">;;       2009-08-21 Remove all cl stuff (list*, loop, etc.).  Add *-remove-if(-not).</span>
<span class="linecomment">;;                  Remove compile-time require of cl.</span>
<span class="linecomment">;;                  Add predicates *-(region|gnus|w3m|info|(remote-|local-)file)-bookmark-p.</span>
<span class="linecomment">;;                  Redefine alist-only functions to optimize and use new preds.</span>
<span class="linecomment">;;       2009-08-20 *--jump-via: Fix to show relocated region before ask whether to save.</span>
<span class="linecomment">;;                  *-relocate-region: Fix ar-str.  Rename a var.  Add: *-region-activated-p.</span>
<span class="linecomment">;;                  Revert chgs.</span>
<span class="linecomment">;;       2009-08-19 Update/fix commentary: bookmark-alist, linkd.</span>
<span class="linecomment">;;                  *-default-handler, *-handle-region-default:</span>
<span class="linecomment">;;                    Get bmk record from name only once.</span>
<span class="linecomment">;;                  *-save-new-region-location: Move t inside progn.</span>
<span class="linecomment">;;       2009-08-16 Use prefix bookmarkp where appropriate.</span>
<span class="linecomment">;;       2009-08-15 Improve comments, doc strings.  Rename fns, vars.</span>
<span class="linecomment">;;                  Add :group with prefix bookmarkp.</span>
<span class="linecomment">;;       2009-08-09 Fix doc strings.</span>
<span class="linecomment">;;       2009-08-08 bookmark-set: Update doc string.  Show keys in C-h m.</span>
<span class="linecomment">;;       2009-08-07 *-jump: Fix to jump in same window (thx to Henry Atting).</span>
<span class="linecomment">;;                  *-at-bol/eol' -&gt; line-*-position.</span>
<span class="linecomment">;;       2009-08-01 bookmark-store: Fix for Emacs 20.</span>
<span class="linecomment">;;       2009-07-27 Ensure we start on an empty w3m buffer.  Add: *-w3m-allow-multi-tabs.</span>
<span class="linecomment">;;       2009-07-24 *-bmenu-mode-map: Define some new keys.</span>
<span class="linecomment">;;       2009-07-23 *-bmenu-list: Add path to file in help-echo.</span>
<span class="linecomment">;;       2009-07-19 Fix title underline.  Highlight bookmark if root logged with tramp.</span>
<span class="linecomment">;;                  Add face for sudo.</span>
<span class="linecomment">;;       2009-07-18 Add: filter functions, option for bookmark-bmenu-list.</span>
<span class="linecomment">;;                  Remove toggle region.</span>
<span class="linecomment">;;                  *-bmenu-list-only-files-entries: Add prefix arg to show remote.</span>
<span class="linecomment">;;       2009-07-14 Add a forgotten test.</span>
<span class="linecomment">;;       2009-07-13 Fix errors.  Give pos in msg even if no search.</span>
<span class="linecomment">;;                  *-from-bob/eob: Fixed like old strict.</span>
<span class="linecomment">;;                  Remove *-relocate-region-(method|from-limits).</span>
<span class="linecomment">;;                  Remove unused code in record fns.  Add: *-relocate-region-function.</span>
<span class="linecomment">;;       2009-07-12 Do not pass args to relocation routines.  Remove use of flet.</span>
<span class="linecomment">;;                  Use skip-chars-*ward.  Use forward-line, not beginning-of-line.</span>
<span class="linecomment">;;                  Remove save-excursion around message.  Correct typo f(ree var BMK).</span>
<span class="linecomment">;;       2009-07-11 Fix *-relocate-region-strict.  Rename fns, adjust defcustom.</span>
<span class="linecomment">;;                  Save relocated region after pushing mark.  Add comments.</span>
<span class="linecomment">;;       2009-07-10 New retrieve fn.  Add looking-* fns.</span>
<span class="linecomment">;;       2009-07-08 Simplify record fns.  Add doc strings.  Add: *-save-relocated-position.</span>
<span class="linecomment">;;                  Fix: updating when relocate (wrt new record fns), string closing,</span>
<span class="linecomment">;;                       free vars, parens, names.</span>
<span class="linecomment">;;       2009-07-06 Fix: *-bmenu-list wrt windows, Info colors.</span>
<span class="linecomment">;;       2009-07-04 Rename fns to record, vars, args of retrieve fns.  Big changes, fixes.</span>
<span class="linecomment">;;       2009-07-01 Fix comments.  *-retrieve-region-strict: improve when out of context.</span>
<span class="linecomment">;;       2009-06-30 Fix: free vars, *-retrieve-region, provide (name).</span>
<span class="linecomment">;;       2009-06-29 Fix: w3m handler, file name for non-file, *-simple-retrieve-position.</span>
<span class="linecomment">;;                  Add: *-retrieve-region-strict.</span>
<span class="linecomment">;;       2009-06-28 Add: *-retrieve-region-method-is, *-retrieve-region-lax,</span>
<span class="linecomment">;;                       fns to retrieve regions.</span>
<span class="linecomment">;;                  Use buffer again, not buffer-name.</span>
<span class="linecomment">;;       2009-06-27 Fix wrong-type error no such file.  Renamed faces.  Add: *-prop-set.</span>
<span class="linecomment">;;                  Load gnus at compile time.  Protect tramp-file-name-regexp with boundp.</span>
<span class="linecomment">;;       2009-06-25 Fixes for older Emacs compatibility.</span>
<span class="linecomment">;;       2009-06-24 Improve *-default-handler.</span>
<span class="linecomment">;;                  Add: *-always-save-relocated-position, *-prop-get.</span>
<span class="linecomment">;;       2009-06-23 Use search-regexp, not re-search-regexp.  Add Gnus bmks.  Add doc.</span>
<span class="linecomment">;;                  Fix *-bmenu-list.</span>
<span class="linecomment">;;       2009-06-21 Fix: *-default-handler for Info.  Improve doc strings, commentary.</span>
<span class="linecomment">;;                  Fixes to be compatible with Emacs 20-22.</span>
<span class="linecomment">;;                  Use defcustom for *-list-only-regions-flag.</span>
<span class="linecomment">;;                  *jump: Put prefix arg in interactive spec.  Use buffer-name, not buffer.</span>
<span class="linecomment">;;                  Remove require of Tramp and inline Tramp fns.</span>
<span class="linecomment">;;                  Remove tests for display-(color|mouse)-p.</span>
<span class="linecomment">;;                  w3m-bookmark-(jump|make-record): require w3m.</span>
<span class="linecomment">;;       2009-06-20 Update context strings when relocate.</span>
<span class="linecomment">;;                  Fix: bookmark-get-*: search from point-min.</span>
<span class="linecomment">;;       2009-06-19 Fix: *-make-record-default, *-toggle-use-only-regions, *-default-handler,</span>
<span class="linecomment">;;                       bookmarking Dired.</span>
<span class="linecomment">;;                  Handle 4 positions in *-default-handler.</span>
<span class="linecomment">;;       2009-06-17 Fix: case where some bookmarked text was removed, *-use-region.</span>
<span class="linecomment">;;       2009-06-15 Fix *-region-alist-only, *-get-buffername, *-location,</span>
<span class="linecomment">;;                      non-file (buffer) bookmarks.</span>
<span class="linecomment">;;                  Support w3m similar to Info.</span>
<span class="linecomment">;;       2009-06-14 Fix bookmark+version, region relocation.  Info support.  Error handling.</span>
<span class="linecomment">;;       2009-06-13 Fix: *-list-only-regions, *-region-handler, *-make-record, keymap, faces.</span>
<span class="linecomment">;;                  Put region & info handling in *-default-handler, not separate handlers.</span>
<span class="linecomment">;;                  Merge *-make-record-region to *-make-record-default.</span>
<span class="linecomment">;;                  *-jump now negates *-use-region if prefix arg.  Raise error if bad bmk.</span>
<span class="linecomment">;;       2009-06-12 Add: *-get-endposition, *-region-alist-only-names.</span>
<span class="linecomment">;;                  Add filter to show only region bookmarks.</span>
<span class="linecomment">;;                  Faces for menu list.  Change region color.</span>
<span class="linecomment">;;       2009-06-11 Add: *-region-search-size, *-get-buffername, *-use-region.</span>
<span class="linecomment">;;                  Redefine *-handle-bookmark, *-jump, to fit bookmark-use-region.</span>
<span class="linecomment">;;                  Add condtions to bookmark-make-record.  Support w3m.  Support t command.</span>
<span class="linecomment">;;       2009-06-10 Fix search regexp.  Fix region in Info. Save bookmark if region moves.</span>
<span class="linecomment">;;       2009-06-09 Added: bookmark-make-record(-region), bookmark-region-handler.</span>
<span class="linecomment">;;                  Relocation.</span>
<span class="linecomment">;; 2009/05/25 dadams</span>
<span class="linecomment">;;     Added redefinition of bookmark-get-bookmark-record.</span>
<span class="linecomment">;; 2008/10/16 dadams</span>
<span class="linecomment">;;     bookmark-jump-other-window: Don't define it for Emacs 23+ (not needed).</span>
<span class="linecomment">;; 2008/04/04 dadams</span>
<span class="linecomment">;;     bookmark-jump-other-window: Updated wrt Emacs 22.2.</span>
<span class="linecomment">;; 2007/10/07 dadams</span>
<span class="linecomment">;;     Added: bookmark-completing-read, bookmark-delete, bookmark-insert(-location),</span>
<span class="linecomment">;;            bookmark-jump, bookmark-relocate, bookmark-rename.</span>
<span class="linecomment">;;     bookmark-jump-other-window: Use new bookmark-completing-read.</span>
<span class="linecomment">;; 2007/07/13 dadams</span>
<span class="linecomment">;;     Replaced Emacs version tests to reflect Emacs 22 release.</span>
<span class="linecomment">;; 2006/03/08 dadams</span>
<span class="linecomment">;;     bookmark-jump-other-window: Handle nil arg.</span>
<span class="linecomment">;; 2005/05/17 dadams</span>
<span class="linecomment">;;     Updated to work with Emacs 22.x.</span>
<span class="linecomment">;; 2004/11/20 dadams</span>
<span class="linecomment">;;     Refined to deal with Emacs 21 &lt; 21.3.50 (soon to be 22.x)</span>
<span class="linecomment">;; 2004/10/26 dadams</span>
<span class="linecomment">;;     Different menu-bar command, depending on Emacs version.</span>
<span class="linecomment">;; 2004/09/21 dadams</span>
<span class="linecomment">;;     Only define bookmark-menu-jump-other-window if &lt; Emacs 22.</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="linecomment">;; </span>
<span class="linecomment">;; This program is free software; you can redistribute it and/or</span>
<span class="linecomment">;; modify it under the terms of the GNU General Public License as</span>
<span class="linecomment">;; published by the Free Software Foundation; either version 3, or</span>
<span class="linecomment">;; (at your option) any later version.</span>
<span class="linecomment">;; </span>
<span class="linecomment">;; This program is distributed in the hope that it will be useful,</span>
<span class="linecomment">;; but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="linecomment">;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="linecomment">;; General Public License for more details.</span>
<span class="linecomment">;; </span>
<span class="linecomment">;; You should have received a copy of the GNU General Public License</span>
<span class="linecomment">;; along with this program; see the file COPYING.  If not, write to</span>
<span class="linecomment">;; the Free Software Foundation, Inc., 51 Franklin Street, Fifth</span>
<span class="linecomment">;; Floor, Boston, MA 02110-1301, USA.</span>
<span class="linecomment">;; </span>
<span class="linecomment">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="linecomment">;;</span>
<span class="linecomment">;;; Code:</span>

<span class="linecomment">;; You need not load this file.  It contains only documentation.</span>

(provide 'bookmark+-chg)                <span class="linecomment">; Not used.</span>

<span class="linecomment">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span class="linecomment">;;; bookmark+-chg.el ends here</span></span></pre></div><div class="wrapper close"></div></div><div class="footer"><hr /><span class="gotobar bar"><a class="local" href="http://www.emacswiki.org/emacs/SiteMap">SiteMap</a> <a class="local" href="http://www.emacswiki.org/emacs/Search">Search</a> <a class="local" href="http://www.emacswiki.org/emacs/ElispArea">ElispArea</a> <a class="local" href="http://www.emacswiki.org/emacs/HowTo">HowTo</a> <a class="local" href="http://www.emacswiki.org/emacs/Glossary">Glossary</a> <a class="local" href="http://www.emacswiki.org/emacs/RecentChanges">RecentChanges</a> <a class="local" href="http://www.emacswiki.org/emacs/News">News</a> <a class="local" href="http://www.emacswiki.org/emacs/Problems">Problems</a> <a class="local" href="http://www.emacswiki.org/emacs/Suggestions">Suggestions</a> </span><span class="translation bar"><br />  <a class="translation new" rel="nofollow" href="http://www.emacswiki.org/emacs?action=translate;id=bookmark+-chg.el;missing=de_es_fr_it_ja_ko_pt_ru_se_zh">Add Translation</a></span><span class="edit bar"><br /> <a class="edit" accesskey="e" title="Click to edit this page" rel="nofollow" href="http://www.emacswiki.org/emacs?action=edit;id=bookmark%2b-chg.el">Edit this page</a> <a class="history" rel="nofollow" href="http://www.emacswiki.org/emacs?action=history;id=bookmark%2b-chg.el">View other revisions</a> <a class="admin" rel="nofollow" href="http://www.emacswiki.org/emacs?action=admin;id=bookmark%2b-chg.el">Administration</a></span><span class="time"><br /> Last edited 2011-08-09 17:37 UTC by <a class="author" title="from 148.87.67.209" href="http://www.emacswiki.org/emacs/DrewAdams">DrewAdams</a> <a class="diff" rel="nofollow" href="http://www.emacswiki.org/emacs?action=browse;diff=2;id=bookmark%2b-chg.el">(diff)</a></span><div style="float:right; margin-left:1ex;">
<!-- Creative Commons License -->
<a href="http://creativecommons.org/licenses/GPL/2.0/"><img alt="CC-GNU GPL" style="border:none" src="/pics/cc-GPL-a.png" /></a>
<!-- /Creative Commons License -->
</div>

<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
 xmlns:dc="http://purl.org/dc/elements/1.1/"
 xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="">
   <license rdf:resource="http://creativecommons.org/licenses/GPL/2.0/" />
  <dc:type rdf:resource="http://purl.org/dc/dcmitype/Software" />
</Work>

<License rdf:about="http://creativecommons.org/licenses/GPL/2.0/">
   <permits rdf:resource="http://web.resource.org/cc/Reproduction" />
   <permits rdf:resource="http://web.resource.org/cc/Distribution" />
   <requires rdf:resource="http://web.resource.org/cc/Notice" />
   <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
   <requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
   <requires rdf:resource="http://web.resource.org/cc/SourceCode" />
</License>
</rdf:RDF>
-->

<p class="legal">
This work is licensed to you under version 2 of the
<a href="http://www.gnu.org/">GNU</a> <a href="/GPL">General Public License</a>.
Alternatively, you may choose to receive this work under any other
license that grants the right to use, copy, modify, and/or distribute
the work, as long as that license imposes the restriction that
derivative works have to grant the same rights and impose the same
restriction. For example, you may choose to receive this work under
the
<a href="http://www.gnu.org/">GNU</a>
<a href="/FDL">Free Documentation License</a>, the
<a href="http://creativecommons.org/">CreativeCommons</a>
<a href="http://creativecommons.org/licenses/sa/1.0/">ShareAlike</a>
License, the XEmacs manual license, or
<a href="/OLD">similar licenses</a>.
</p>
</div>
</body>
</html>
